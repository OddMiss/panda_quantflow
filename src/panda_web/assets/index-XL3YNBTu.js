import{d as Qt,r as x,H as rt,c as B,o as N,b as o,F as at,k as ht,i as z,t as I,_ as bt,a as dt,V as _n,a0 as $e,B as Ge,e as kn,v as ft,y as pt,z as En,m as Ae,L as Sn,N as wt,I as Tn,f as Ct,C as Je,h as ut,a1 as $t,A as Mt,x as Cn,J as De,g as Rn,j as V,l as xn}from"./main-By7XujwE.js";import{r as $n}from"./index-CdmoIaXP.js";const An="http://localhost:8111",Dn=1e4;function Pn(e){var t;throw(e==null?void 0:e.name)==="AbortError"?new Error("请求超时,超过10秒"):(t=e==null?void 0:e.message)!=null&&t.includes("Failed to fetch")?new Error("网络连接失败，请检查网络是否正常！"):(console.log("请求错误:",e),e)}async function Z(e,t){const n={},s=localStorage.getItem("token"),a=localStorage.getItem("userid");s&&a&&(n.Authorization=`${s}`,n.userId=`${a}`);const r=new AbortController,i=setTimeout(()=>r.abort(),Dn);try{const l=await fetch(An+"/"+e,{headers:n,...t,signal:r.signal});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return Promise.resolve({response:l,httpController:r})}catch(l){Pn(l)}finally{clearTimeout(i)}}async function fo(e){try{const t=await Z(`api/v1/query_one_group_data?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function po(e){try{const t=await Z(`api/v1/query_factor_analysis_data?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function ho(e){try{const t=await Z(`api/v1/query_ic_decay_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function bo(e){try{const t=await Z(`api/v1/query_ic_density_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function go(e){try{const t=await Z(`api/v1/query_ic_sequence_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function yo(e){try{const t=await Z(`api/v1/query_ic_self_correlation_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function mo(e){try{const t=await Z(`api/v1/query_rank_ic_decay_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function wo(e){try{const t=await Z(`api/v1/query_rank_ic_density_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function vo(e){try{const t=await Z(`api/v1/query_rank_ic_sequence_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function _o(e){try{const t=await Z(`api/v1/query_rank_ic_self_correlation_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function ko(e){try{const t=await Z(`api/v1/query_return_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Eo(e){try{const t=await Z(`api/v1/query_factor_excess_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function So(e){try{const t=await Z(`api/v1/query_group_return_analysis?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function To(e){try{const t=await Z(`api/v1/query_last_date_top_factor?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Co(e){try{const t=await Z(`api/v1/query_return_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}function We(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ln}=Object.prototype,{getPrototypeOf:te}=Object,{iterator:Ft,toStringTag:Ye}=Symbol,jt=(e=>t=>{const n=Ln.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ot=e=>(e=e.toLowerCase(),t=>jt(t)===e),Nt=e=>t=>typeof t===e,{isArray:vt}=Array,Tt=Nt("undefined");function On(e){return e!==null&&!Tt(e)&&e.constructor!==null&&!Tt(e.constructor)&&tt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Ke=ot("ArrayBuffer");function Fn(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Ke(e.buffer),t}const jn=Nt("string"),tt=Nt("function"),Xe=Nt("number"),Bt=e=>e!==null&&typeof e=="object",Nn=e=>e===!0||e===!1,At=e=>{if(jt(e)!=="object")return!1;const t=te(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Ye in e)&&!(Ft in e)},Bn=ot("Date"),In=ot("File"),qn=ot("Blob"),Un=ot("FileList"),Mn=e=>Bt(e)&&tt(e.pipe),zn=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||tt(e.append)&&((t=jt(e))==="formdata"||t==="object"&&tt(e.toString)&&e.toString()==="[object FormData]"))},Hn=ot("URLSearchParams"),[Vn,Gn,Jn,Wn]=["ReadableStream","Request","Response","Headers"].map(ot),Yn=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Rt(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,a;if(typeof e!="object"&&(e=[e]),vt(e))for(s=0,a=e.length;s<a;s++)t.call(null,e[s],s,e);else{const r=n?Object.getOwnPropertyNames(e):Object.keys(e),i=r.length;let l;for(s=0;s<i;s++)l=r[s],t.call(null,e[l],l,e)}}function Ze(e,t){t=t.toLowerCase();const n=Object.keys(e);let s=n.length,a;for(;s-- >0;)if(a=n[s],t===a.toLowerCase())return a;return null}const gt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Qe=e=>!Tt(e)&&e!==gt;function Jt(){const{caseless:e}=Qe(this)&&this||{},t={},n=(s,a)=>{const r=e&&Ze(t,a)||a;At(t[r])&&At(s)?t[r]=Jt(t[r],s):At(s)?t[r]=Jt({},s):vt(s)?t[r]=s.slice():t[r]=s};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Rt(arguments[s],n);return t}const Kn=(e,t,n,{allOwnKeys:s}={})=>(Rt(t,(a,r)=>{n&&tt(a)?e[r]=We(a,n):e[r]=a},{allOwnKeys:s}),e),Xn=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Zn=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Qn=(e,t,n,s)=>{let a,r,i;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),r=a.length;r-- >0;)i=a[r],(!s||s(i,e,t))&&!l[i]&&(t[i]=e[i],l[i]=!0);e=n!==!1&&te(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},ts=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},es=e=>{if(!e)return null;if(vt(e))return e;let t=e.length;if(!Xe(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},ns=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&te(Uint8Array)),ss=(e,t)=>{const s=(e&&e[Ft]).call(e);let a;for(;(a=s.next())&&!a.done;){const r=a.value;t.call(e,r[0],r[1])}},as=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},rs=ot("HTMLFormElement"),os=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,a){return s.toUpperCase()+a}),Pe=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),is=ot("RegExp"),tn=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};Rt(n,(a,r)=>{let i;(i=t(a,r,e))!==!1&&(s[r]=i||a)}),Object.defineProperties(e,s)},ls=e=>{tn(e,(t,n)=>{if(tt(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(tt(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},cs=(e,t)=>{const n={},s=a=>{a.forEach(r=>{n[r]=!0})};return vt(e)?s(e):s(String(e).split(t)),n},us=()=>{},ds=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function fs(e){return!!(e&&tt(e.append)&&e[Ye]==="FormData"&&e[Ft])}const ps=e=>{const t=new Array(10),n=(s,a)=>{if(Bt(s)){if(t.indexOf(s)>=0)return;if(!("toJSON"in s)){t[a]=s;const r=vt(s)?[]:{};return Rt(s,(i,l)=>{const h=n(i,a+1);!Tt(h)&&(r[l]=h)}),t[a]=void 0,r}}return s};return n(e,0)},hs=ot("AsyncFunction"),bs=e=>e&&(Bt(e)||tt(e))&&tt(e.then)&&tt(e.catch),en=((e,t)=>e?setImmediate:t?((n,s)=>(gt.addEventListener("message",({source:a,data:r})=>{a===gt&&r===n&&s.length&&s.shift()()},!1),a=>{s.push(a),gt.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",tt(gt.postMessage)),gs=typeof queueMicrotask<"u"?queueMicrotask.bind(gt):typeof process<"u"&&process.nextTick||en,ys=e=>e!=null&&tt(e[Ft]),c={isArray:vt,isArrayBuffer:Ke,isBuffer:On,isFormData:zn,isArrayBufferView:Fn,isString:jn,isNumber:Xe,isBoolean:Nn,isObject:Bt,isPlainObject:At,isReadableStream:Vn,isRequest:Gn,isResponse:Jn,isHeaders:Wn,isUndefined:Tt,isDate:Bn,isFile:In,isBlob:qn,isRegExp:is,isFunction:tt,isStream:Mn,isURLSearchParams:Hn,isTypedArray:ns,isFileList:Un,forEach:Rt,merge:Jt,extend:Kn,trim:Yn,stripBOM:Xn,inherits:Zn,toFlatObject:Qn,kindOf:jt,kindOfTest:ot,endsWith:ts,toArray:es,forEachEntry:ss,matchAll:as,isHTMLForm:rs,hasOwnProperty:Pe,hasOwnProp:Pe,reduceDescriptors:tn,freezeMethods:ls,toObjectSet:cs,toCamelCase:os,noop:us,toFiniteNumber:ds,findKey:Ze,global:gt,isContextDefined:Qe,isSpecCompliantForm:fs,toJSONObject:ps,isAsyncFn:hs,isThenable:bs,setImmediate:en,asap:gs,isIterable:ys};function q(e,t,n,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}c.inherits(q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:c.toJSONObject(this.config),code:this.code,status:this.status}}});const nn=q.prototype,sn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{sn[e]={value:e}});Object.defineProperties(q,sn);Object.defineProperty(nn,"isAxiosError",{value:!0});q.from=(e,t,n,s,a,r)=>{const i=Object.create(nn);return c.toFlatObject(e,i,function(h){return h!==Error.prototype},l=>l!=="isAxiosError"),q.call(i,e.message,t,n,s,a),i.cause=e,i.name=e.name,r&&Object.assign(i,r),i};const ms=null;function Wt(e){return c.isPlainObject(e)||c.isArray(e)}function an(e){return c.endsWith(e,"[]")?e.slice(0,-2):e}function Le(e,t,n){return e?e.concat(t).map(function(a,r){return a=an(a),!n&&r?"["+a+"]":a}).join(n?".":""):t}function ws(e){return c.isArray(e)&&!e.some(Wt)}const vs=c.toFlatObject(c,{},null,function(t){return/^is[A-Z]/.test(t)});function It(e,t,n){if(!c.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=c.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,_){return!c.isUndefined(_[S])});const s=n.metaTokens,a=n.visitor||d,r=n.dots,i=n.indexes,h=(n.Blob||typeof Blob<"u"&&Blob)&&c.isSpecCompliantForm(t);if(!c.isFunction(a))throw new TypeError("visitor must be a function");function u(b){if(b===null)return"";if(c.isDate(b))return b.toISOString();if(!h&&c.isBlob(b))throw new q("Blob is not supported. Use a Buffer instead.");return c.isArrayBuffer(b)||c.isTypedArray(b)?h&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function d(b,S,_){let R=b;if(b&&!_&&typeof b=="object"){if(c.endsWith(S,"{}"))S=s?S:S.slice(0,-2),b=JSON.stringify(b);else if(c.isArray(b)&&ws(b)||(c.isFileList(b)||c.endsWith(S,"[]"))&&(R=c.toArray(b)))return S=an(S),R.forEach(function(v,M){!(c.isUndefined(v)||v===null)&&t.append(i===!0?Le([S],M,r):i===null?S:S+"[]",u(v))}),!1}return Wt(b)?!0:(t.append(Le(_,S,r),u(b)),!1)}const p=[],k=Object.assign(vs,{defaultVisitor:d,convertValue:u,isVisitable:Wt});function g(b,S){if(!c.isUndefined(b)){if(p.indexOf(b)!==-1)throw Error("Circular reference detected in "+S.join("."));p.push(b),c.forEach(b,function(R,y){(!(c.isUndefined(R)||R===null)&&a.call(t,R,c.isString(y)?y.trim():y,S,k))===!0&&g(R,S?S.concat(y):[y])}),p.pop()}}if(!c.isObject(e))throw new TypeError("data must be an object");return g(e),t}function Oe(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function ee(e,t){this._pairs=[],e&&It(e,this,t)}const rn=ee.prototype;rn.append=function(t,n){this._pairs.push([t,n])};rn.toString=function(t){const n=t?function(s){return t.call(this,s,Oe)}:Oe;return this._pairs.map(function(a){return n(a[0])+"="+n(a[1])},"").join("&")};function _s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function on(e,t,n){if(!t)return e;const s=n&&n.encode||_s;c.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let r;if(a?r=a(t,n):r=c.isURLSearchParams(t)?t.toString():new ee(t,n).toString(s),r){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+r}return e}class Fe{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){c.forEach(this.handlers,function(s){s!==null&&t(s)})}}const ln={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ks=typeof URLSearchParams<"u"?URLSearchParams:ee,Es=typeof FormData<"u"?FormData:null,Ss=typeof Blob<"u"?Blob:null,Ts={isBrowser:!0,classes:{URLSearchParams:ks,FormData:Es,Blob:Ss},protocols:["http","https","file","blob","url","data"]},ne=typeof window<"u"&&typeof document<"u",Yt=typeof navigator=="object"&&navigator||void 0,Cs=ne&&(!Yt||["ReactNative","NativeScript","NS"].indexOf(Yt.product)<0),Rs=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",xs=ne&&window.location.href||"http://localhost",$s=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ne,hasStandardBrowserEnv:Cs,hasStandardBrowserWebWorkerEnv:Rs,navigator:Yt,origin:xs},Symbol.toStringTag,{value:"Module"})),X={...$s,...Ts};function As(e,t){return It(e,new X.classes.URLSearchParams,Object.assign({visitor:function(n,s,a,r){return X.isNode&&c.isBuffer(n)?(this.append(s,n.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}function Ds(e){return c.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Ps(e){const t={},n=Object.keys(e);let s;const a=n.length;let r;for(s=0;s<a;s++)r=n[s],t[r]=e[r];return t}function cn(e){function t(n,s,a,r){let i=n[r++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),h=r>=n.length;return i=!i&&c.isArray(a)?a.length:i,h?(c.hasOwnProp(a,i)?a[i]=[a[i],s]:a[i]=s,!l):((!a[i]||!c.isObject(a[i]))&&(a[i]=[]),t(n,s,a[i],r)&&c.isArray(a[i])&&(a[i]=Ps(a[i])),!l)}if(c.isFormData(e)&&c.isFunction(e.entries)){const n={};return c.forEachEntry(e,(s,a)=>{t(Ds(s),a,n,0)}),n}return null}function Ls(e,t,n){if(c.isString(e))try{return(t||JSON.parse)(e),c.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const xt={transitional:ln,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",a=s.indexOf("application/json")>-1,r=c.isObject(t);if(r&&c.isHTMLForm(t)&&(t=new FormData(t)),c.isFormData(t))return a?JSON.stringify(cn(t)):t;if(c.isArrayBuffer(t)||c.isBuffer(t)||c.isStream(t)||c.isFile(t)||c.isBlob(t)||c.isReadableStream(t))return t;if(c.isArrayBufferView(t))return t.buffer;if(c.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(r){if(s.indexOf("application/x-www-form-urlencoded")>-1)return As(t,this.formSerializer).toString();if((l=c.isFileList(t))||s.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return It(l?{"files[]":t}:t,h&&new h,this.formSerializer)}}return r||a?(n.setContentType("application/json",!1),Ls(t)):t}],transformResponse:[function(t){const n=this.transitional||xt.transitional,s=n&&n.forcedJSONParsing,a=this.responseType==="json";if(c.isResponse(t)||c.isReadableStream(t))return t;if(t&&c.isString(t)&&(s&&!this.responseType||a)){const i=!(n&&n.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(i)throw l.name==="SyntaxError"?q.from(l,q.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:X.classes.FormData,Blob:X.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};c.forEach(["delete","get","head","post","put","patch"],e=>{xt.headers[e]={}});const Os=c.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Fs=e=>{const t={};let n,s,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),n=i.substring(0,a).trim().toLowerCase(),s=i.substring(a+1).trim(),!(!n||t[n]&&Os[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},je=Symbol("internals");function St(e){return e&&String(e).trim().toLowerCase()}function Dt(e){return e===!1||e==null?e:c.isArray(e)?e.map(Dt):String(e)}function js(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const Ns=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function zt(e,t,n,s,a){if(c.isFunction(s))return s.call(this,t,n);if(a&&(t=n),!!c.isString(t)){if(c.isString(s))return t.indexOf(s)!==-1;if(c.isRegExp(s))return s.test(t)}}function Bs(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function Is(e,t){const n=c.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(a,r,i){return this[s].call(this,t,a,r,i)},configurable:!0})})}let et=class{constructor(t){t&&this.set(t)}set(t,n,s){const a=this;function r(l,h,u){const d=St(h);if(!d)throw new Error("header name must be a non-empty string");const p=c.findKey(a,d);(!p||a[p]===void 0||u===!0||u===void 0&&a[p]!==!1)&&(a[p||h]=Dt(l))}const i=(l,h)=>c.forEach(l,(u,d)=>r(u,d,h));if(c.isPlainObject(t)||t instanceof this.constructor)i(t,n);else if(c.isString(t)&&(t=t.trim())&&!Ns(t))i(Fs(t),n);else if(c.isObject(t)&&c.isIterable(t)){let l={},h,u;for(const d of t){if(!c.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(h=l[u])?c.isArray(h)?[...h,d[1]]:[h,d[1]]:d[1]}i(l,n)}else t!=null&&r(n,t,s);return this}get(t,n){if(t=St(t),t){const s=c.findKey(this,t);if(s){const a=this[s];if(!n)return a;if(n===!0)return js(a);if(c.isFunction(n))return n.call(this,a,s);if(c.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=St(t),t){const s=c.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||zt(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let a=!1;function r(i){if(i=St(i),i){const l=c.findKey(s,i);l&&(!n||zt(s,s[l],l,n))&&(delete s[l],a=!0)}}return c.isArray(t)?t.forEach(r):r(t),a}clear(t){const n=Object.keys(this);let s=n.length,a=!1;for(;s--;){const r=n[s];(!t||zt(this,this[r],r,t,!0))&&(delete this[r],a=!0)}return a}normalize(t){const n=this,s={};return c.forEach(this,(a,r)=>{const i=c.findKey(s,r);if(i){n[i]=Dt(a),delete n[r];return}const l=t?Bs(r):String(r).trim();l!==r&&delete n[r],n[l]=Dt(a),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return c.forEach(this,(s,a)=>{s!=null&&s!==!1&&(n[a]=t&&c.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(a=>s.set(a)),s}static accessor(t){const s=(this[je]=this[je]={accessors:{}}).accessors,a=this.prototype;function r(i){const l=St(i);s[l]||(Is(a,i),s[l]=!0)}return c.isArray(t)?t.forEach(r):r(t),this}};et.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);c.reduceDescriptors(et.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});c.freezeMethods(et);function Ht(e,t){const n=this||xt,s=t||n,a=et.from(s.headers);let r=s.data;return c.forEach(e,function(l){r=l.call(n,r,a.normalize(),t?t.status:void 0)}),a.normalize(),r}function un(e){return!!(e&&e.__CANCEL__)}function _t(e,t,n){q.call(this,e??"canceled",q.ERR_CANCELED,t,n),this.name="CanceledError"}c.inherits(_t,q,{__CANCEL__:!0});function dn(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new q("Request failed with status code "+n.status,[q.ERR_BAD_REQUEST,q.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function qs(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Us(e,t){e=e||10;const n=new Array(e),s=new Array(e);let a=0,r=0,i;return t=t!==void 0?t:1e3,function(h){const u=Date.now(),d=s[r];i||(i=u),n[a]=h,s[a]=u;let p=r,k=0;for(;p!==a;)k+=n[p++],p=p%e;if(a=(a+1)%e,a===r&&(r=(r+1)%e),u-i<t)return;const g=d&&u-d;return g?Math.round(k*1e3/g):void 0}}function Ms(e,t){let n=0,s=1e3/t,a,r;const i=(u,d=Date.now())=>{n=d,a=null,r&&(clearTimeout(r),r=null),e.apply(null,u)};return[(...u)=>{const d=Date.now(),p=d-n;p>=s?i(u,d):(a=u,r||(r=setTimeout(()=>{r=null,i(a)},s-p)))},()=>a&&i(a)]}const Lt=(e,t,n=3)=>{let s=0;const a=Us(50,250);return Ms(r=>{const i=r.loaded,l=r.lengthComputable?r.total:void 0,h=i-s,u=a(h),d=i<=l;s=i;const p={loaded:i,total:l,progress:l?i/l:void 0,bytes:h,rate:u||void 0,estimated:u&&l&&d?(l-i)/u:void 0,event:r,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(p)},n)},Ne=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},Be=e=>(...t)=>c.asap(()=>e(...t)),zs=X.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,X.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(X.origin),X.navigator&&/(msie|trident)/i.test(X.navigator.userAgent)):()=>!0,Hs=X.hasStandardBrowserEnv?{write(e,t,n,s,a,r){const i=[e+"="+encodeURIComponent(t)];c.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),c.isString(s)&&i.push("path="+s),c.isString(a)&&i.push("domain="+a),r===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Vs(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Gs(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function fn(e,t,n){let s=!Vs(t);return e&&(s||n==!1)?Gs(e,t):t}const Ie=e=>e instanceof et?{...e}:e;function mt(e,t){t=t||{};const n={};function s(u,d,p,k){return c.isPlainObject(u)&&c.isPlainObject(d)?c.merge.call({caseless:k},u,d):c.isPlainObject(d)?c.merge({},d):c.isArray(d)?d.slice():d}function a(u,d,p,k){if(c.isUndefined(d)){if(!c.isUndefined(u))return s(void 0,u,p,k)}else return s(u,d,p,k)}function r(u,d){if(!c.isUndefined(d))return s(void 0,d)}function i(u,d){if(c.isUndefined(d)){if(!c.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function l(u,d,p){if(p in t)return s(u,d);if(p in e)return s(void 0,u)}const h={url:r,method:r,data:r,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(u,d,p)=>a(Ie(u),Ie(d),p,!0)};return c.forEach(Object.keys(Object.assign({},e,t)),function(d){const p=h[d]||a,k=p(e[d],t[d],d);c.isUndefined(k)&&p!==l||(n[d]=k)}),n}const pn=e=>{const t=mt({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:r,headers:i,auth:l}=t;t.headers=i=et.from(i),t.url=on(fn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let h;if(c.isFormData(n)){if(X.hasStandardBrowserEnv||X.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((h=i.getContentType())!==!1){const[u,...d]=h?h.split(";").map(p=>p.trim()).filter(Boolean):[];i.setContentType([u||"multipart/form-data",...d].join("; "))}}if(X.hasStandardBrowserEnv&&(s&&c.isFunction(s)&&(s=s(t)),s||s!==!1&&zs(t.url))){const u=a&&r&&Hs.read(r);u&&i.set(a,u)}return t},Js=typeof XMLHttpRequest<"u",Ws=Js&&function(e){return new Promise(function(n,s){const a=pn(e);let r=a.data;const i=et.from(a.headers).normalize();let{responseType:l,onUploadProgress:h,onDownloadProgress:u}=a,d,p,k,g,b;function S(){g&&g(),b&&b(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let _=new XMLHttpRequest;_.open(a.method.toUpperCase(),a.url,!0),_.timeout=a.timeout;function R(){if(!_)return;const v=et.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),U={data:!l||l==="text"||l==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:v,config:e,request:_};dn(function(Q){n(Q),S()},function(Q){s(Q),S()},U),_=null}"onloadend"in _?_.onloadend=R:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(R)},_.onabort=function(){_&&(s(new q("Request aborted",q.ECONNABORTED,e,_)),_=null)},_.onerror=function(){s(new q("Network Error",q.ERR_NETWORK,e,_)),_=null},_.ontimeout=function(){let M=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const U=a.transitional||ln;a.timeoutErrorMessage&&(M=a.timeoutErrorMessage),s(new q(M,U.clarifyTimeoutError?q.ETIMEDOUT:q.ECONNABORTED,e,_)),_=null},r===void 0&&i.setContentType(null),"setRequestHeader"in _&&c.forEach(i.toJSON(),function(M,U){_.setRequestHeader(U,M)}),c.isUndefined(a.withCredentials)||(_.withCredentials=!!a.withCredentials),l&&l!=="json"&&(_.responseType=a.responseType),u&&([k,b]=Lt(u,!0),_.addEventListener("progress",k)),h&&_.upload&&([p,g]=Lt(h),_.upload.addEventListener("progress",p),_.upload.addEventListener("loadend",g)),(a.cancelToken||a.signal)&&(d=v=>{_&&(s(!v||v.type?new _t(null,e,_):v),_.abort(),_=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const y=qs(a.url);if(y&&X.protocols.indexOf(y)===-1){s(new q("Unsupported protocol "+y+":",q.ERR_BAD_REQUEST,e));return}_.send(r||null)})},Ys=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,a;const r=function(u){if(!a){a=!0,l();const d=u instanceof Error?u:this.reason;s.abort(d instanceof q?d:new _t(d instanceof Error?d.message:d))}};let i=t&&setTimeout(()=>{i=null,r(new q(`timeout ${t} of ms exceeded`,q.ETIMEDOUT))},t);const l=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(r):u.removeEventListener("abort",r)}),e=null)};e.forEach(u=>u.addEventListener("abort",r));const{signal:h}=s;return h.unsubscribe=()=>c.asap(l),h}},Ks=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,a;for(;s<n;)a=s+t,yield e.slice(s,a),s=a},Xs=async function*(e,t){for await(const n of Zs(e))yield*Ks(n,t)},Zs=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},qe=(e,t,n,s)=>{const a=Xs(e,t);let r=0,i,l=h=>{i||(i=!0,s&&s(h))};return new ReadableStream({async pull(h){try{const{done:u,value:d}=await a.next();if(u){l(),h.close();return}let p=d.byteLength;if(n){let k=r+=p;n(k)}h.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(h){return l(h),a.return()}},{highWaterMark:2})},qt=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",hn=qt&&typeof ReadableStream=="function",Qs=qt&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),bn=(e,...t)=>{try{return!!e(...t)}catch{return!1}},ta=hn&&bn(()=>{let e=!1;const t=new Request(X.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Ue=64*1024,Kt=hn&&bn(()=>c.isReadableStream(new Response("").body)),Ot={stream:Kt&&(e=>e.body)};qt&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Ot[t]&&(Ot[t]=c.isFunction(e[t])?n=>n[t]():(n,s)=>{throw new q(`Response type '${t}' is not supported`,q.ERR_NOT_SUPPORT,s)})})})(new Response);const ea=async e=>{if(e==null)return 0;if(c.isBlob(e))return e.size;if(c.isSpecCompliantForm(e))return(await new Request(X.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(c.isArrayBufferView(e)||c.isArrayBuffer(e))return e.byteLength;if(c.isURLSearchParams(e)&&(e=e+""),c.isString(e))return(await Qs(e)).byteLength},na=async(e,t)=>{const n=c.toFiniteNumber(e.getContentLength());return n??ea(t)},sa=qt&&(async e=>{let{url:t,method:n,data:s,signal:a,cancelToken:r,timeout:i,onDownloadProgress:l,onUploadProgress:h,responseType:u,headers:d,withCredentials:p="same-origin",fetchOptions:k}=pn(e);u=u?(u+"").toLowerCase():"text";let g=Ys([a,r&&r.toAbortSignal()],i),b;const S=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let _;try{if(h&&ta&&n!=="get"&&n!=="head"&&(_=await na(d,s))!==0){let U=new Request(t,{method:"POST",body:s,duplex:"half"}),G;if(c.isFormData(s)&&(G=U.headers.get("content-type"))&&d.setContentType(G),U.body){const[Q,T]=Ne(_,Lt(Be(h)));s=qe(U.body,Ue,Q,T)}}c.isString(p)||(p=p?"include":"omit");const R="credentials"in Request.prototype;b=new Request(t,{...k,signal:g,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:s,duplex:"half",credentials:R?p:void 0});let y=await fetch(b);const v=Kt&&(u==="stream"||u==="response");if(Kt&&(l||v&&S)){const U={};["status","statusText","headers"].forEach(f=>{U[f]=y[f]});const G=c.toFiniteNumber(y.headers.get("content-length")),[Q,T]=l&&Ne(G,Lt(Be(l),!0))||[];y=new Response(qe(y.body,Ue,Q,()=>{T&&T(),S&&S()}),U)}u=u||"text";let M=await Ot[c.findKey(Ot,u)||"text"](y,e);return!v&&S&&S(),await new Promise((U,G)=>{dn(U,G,{data:M,headers:et.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:b})})}catch(R){throw S&&S(),R&&R.name==="TypeError"&&/Load failed|fetch/i.test(R.message)?Object.assign(new q("Network Error",q.ERR_NETWORK,e,b),{cause:R.cause||R}):q.from(R,R&&R.code,e,b)}}),Xt={http:ms,xhr:Ws,fetch:sa};c.forEach(Xt,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Me=e=>`- ${e}`,aa=e=>c.isFunction(e)||e===null||e===!1,gn={getAdapter:e=>{e=c.isArray(e)?e:[e];const{length:t}=e;let n,s;const a={};for(let r=0;r<t;r++){n=e[r];let i;if(s=n,!aa(n)&&(s=Xt[(i=String(n)).toLowerCase()],s===void 0))throw new q(`Unknown adapter '${i}'`);if(s)break;a[i||"#"+r]=s}if(!s){const r=Object.entries(a).map(([l,h])=>`adapter ${l} `+(h===!1?"is not supported by the environment":"is not available in the build"));let i=t?r.length>1?`since :
`+r.map(Me).join(`
`):" "+Me(r[0]):"as no adapter specified";throw new q("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return s},adapters:Xt};function Vt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new _t(null,e)}function ze(e){return Vt(e),e.headers=et.from(e.headers),e.data=Ht.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),gn.getAdapter(e.adapter||xt.adapter)(e).then(function(s){return Vt(e),s.data=Ht.call(e,e.transformResponse,s),s.headers=et.from(s.headers),s},function(s){return un(s)||(Vt(e),s&&s.response&&(s.response.data=Ht.call(e,e.transformResponse,s.response),s.response.headers=et.from(s.response.headers))),Promise.reject(s)})}const yn="1.9.0",Ut={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ut[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const He={};Ut.transitional=function(t,n,s){function a(r,i){return"[Axios v"+yn+"] Transitional option '"+r+"'"+i+(s?". "+s:"")}return(r,i,l)=>{if(t===!1)throw new q(a(i," has been removed"+(n?" in "+n:"")),q.ERR_DEPRECATED);return n&&!He[i]&&(He[i]=!0,console.warn(a(i," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(r,i,l):!0}};Ut.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function ra(e,t,n){if(typeof e!="object")throw new q("options must be an object",q.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let a=s.length;for(;a-- >0;){const r=s[a],i=t[r];if(i){const l=e[r],h=l===void 0||i(l,r,e);if(h!==!0)throw new q("option "+r+" must be "+h,q.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new q("Unknown option "+r,q.ERR_BAD_OPTION)}}const Pt={assertOptions:ra,validators:Ut},lt=Pt.validators;let yt=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Fe,response:new Fe}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const r=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?r&&!String(s.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+r):s.stack=r}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=mt(this.defaults,n);const{transitional:s,paramsSerializer:a,headers:r}=n;s!==void 0&&Pt.assertOptions(s,{silentJSONParsing:lt.transitional(lt.boolean),forcedJSONParsing:lt.transitional(lt.boolean),clarifyTimeoutError:lt.transitional(lt.boolean)},!1),a!=null&&(c.isFunction(a)?n.paramsSerializer={serialize:a}:Pt.assertOptions(a,{encode:lt.function,serialize:lt.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Pt.assertOptions(n,{baseUrl:lt.spelling("baseURL"),withXsrfToken:lt.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=r&&c.merge(r.common,r[n.method]);r&&c.forEach(["delete","get","head","post","put","patch","common"],b=>{delete r[b]}),n.headers=et.concat(i,r);const l=[];let h=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(n)===!1||(h=h&&S.synchronous,l.unshift(S.fulfilled,S.rejected))});const u=[];this.interceptors.response.forEach(function(S){u.push(S.fulfilled,S.rejected)});let d,p=0,k;if(!h){const b=[ze.bind(this),void 0];for(b.unshift.apply(b,l),b.push.apply(b,u),k=b.length,d=Promise.resolve(n);p<k;)d=d.then(b[p++],b[p++]);return d}k=l.length;let g=n;for(p=0;p<k;){const b=l[p++],S=l[p++];try{g=b(g)}catch(_){S.call(this,_);break}}try{d=ze.call(this,g)}catch(b){return Promise.reject(b)}for(p=0,k=u.length;p<k;)d=d.then(u[p++],u[p++]);return d}getUri(t){t=mt(this.defaults,t);const n=fn(t.baseURL,t.url,t.allowAbsoluteUrls);return on(n,t.params,t.paramsSerializer)}};c.forEach(["delete","get","head","options"],function(t){yt.prototype[t]=function(n,s){return this.request(mt(s||{},{method:t,url:n,data:(s||{}).data}))}});c.forEach(["post","put","patch"],function(t){function n(s){return function(r,i,l){return this.request(mt(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:r,data:i}))}}yt.prototype[t]=n(),yt.prototype[t+"Form"]=n(!0)});let oa=class mn{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(r){n=r});const s=this;this.promise.then(a=>{if(!s._listeners)return;let r=s._listeners.length;for(;r-- >0;)s._listeners[r](a);s._listeners=null}),this.promise.then=a=>{let r;const i=new Promise(l=>{s.subscribe(l),r=l}).then(a);return i.cancel=function(){s.unsubscribe(r)},i},t(function(r,i,l){s.reason||(s.reason=new _t(r,i,l),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new mn(function(a){t=a}),cancel:t}}};function ia(e){return function(n){return e.apply(null,n)}}function la(e){return c.isObject(e)&&e.isAxiosError===!0}const Zt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Zt).forEach(([e,t])=>{Zt[t]=e});function wn(e){const t=new yt(e),n=We(yt.prototype.request,t);return c.extend(n,yt.prototype,t,{allOwnKeys:!0}),c.extend(n,t,null,{allOwnKeys:!0}),n.create=function(a){return wn(mt(e,a))},n}const J=wn(xt);J.Axios=yt;J.CanceledError=_t;J.CancelToken=oa;J.isCancel=un;J.VERSION=yn;J.toFormData=It;J.AxiosError=q;J.Cancel=J.CanceledError;J.all=function(t){return Promise.all(t)};J.spread=ia;J.isAxiosError=la;J.mergeConfig=mt;J.AxiosHeaders=et;J.formToJSON=e=>cn(c.isHTMLForm(e)?new FormData(e):e);J.getAdapter=gn.getAdapter;J.HttpStatusCode=Zt;J.default=J;const{Axios:$o,AxiosError:Ao,CanceledError:Do,isCancel:Po,CancelToken:Lo,VERSION:Oo,all:Fo,Cancel:jo,isAxiosError:No,spread:Bo,toFormData:Io,AxiosHeaders:qo,HttpStatusCode:Uo,formToJSON:Mo,getAdapter:zo,mergeConfig:Ho}=J,ca={class:"tab-container"},ua={class:"tab-list"},da=["onClick"],fa=Qt({__name:"tab",props:{tabList:{},defaultTab:{}},emits:["update:tab"],setup(e,{emit:t}){var i;const n=e,s=t,a=x(n.defaultTab||((i=n.tabList[0])==null?void 0:i.value)||"");rt(()=>n.defaultTab,l=>{l&&(a.value=l)});const r=l=>{a.value=l.value,s("update:tab",l.value)};return(l,h)=>(N(),B("div",ca,[o("div",ua,[(N(!0),B(at,null,ht(l.tabList,(u,d)=>(N(),B("div",{key:d,class:z(["tab-item",{active:a.value===u.value}]),onClick:p=>r(u)},I(u.label),11,da))),128))])]))}}),vn=bt(fa,[["__scopeId","data-v-bdec3bfa"]]),pa={class:"title"},ha={style:{transform:"rotate(180deg)"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"32302",width:"16",height:"16"},ba={class:"title-text"},ga=Qt({__name:"title",props:{title:{},backs:{}},emits:["back"],setup(e,{emit:t}){const n=t,s=()=>{console.log("返回上一个"),n("back")};return(a,r)=>(N(),B("div",pa,[a.backs?(N(),B("div",{key:0,class:"back-btn",onClick:s},[(N(),B("svg",ha,r[0]||(r[0]=[o("path",{"data-v-da8ede72":"",d:"M722.438 510.815c-0.246-0.246-0.513-0.454-0.766-0.69l-299.893-299.892c-14.231-14.24-37.291-14.24-51.529 0-14.241 14.231-14.241 37.291 0 51.529l274.851 274.859-274.849 274.851c-14.241 14.237-14.241 37.301 0 51.532 7.116 7.119 16.436 10.682 25.764 10.682 9.321 0 18.644-3.563 25.763-10.682l299.905-299.901c0.246-0.234 0.51-0.438 0.751-0.678 7.129-7.13 10.685-16.469 10.674-25.804 0.006-9.337-3.55-18.676-10.674-25.804z",fill:"#ffffff","p-id":"32303"},null,-1)])))])):dt("",!0),o("div",ba,I(a.title),1)]))}}),ya=bt(ga,[["__scopeId","data-v-c5b498c8"]]),Ve=e=>new Date(e).toLocaleString().replace(/\//g,"-"),Vo=e=>!isNaN(e)&&Number.isFinite(Number(e))&&String(e).includes(".")?Number(e).toFixed(2):e,Go=(e=new Date)=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${s}`},ct="http://localhost:8000",Gt="http://localhost:8111",kt=_n("api",()=>{const e=x(""),t=x(""),n=x(null);x(null);const s=x("strategy"),a=x("strategy"),r=x(null),i=x("month"),l=x(""),h=x(""),u=x(null),d=x(null),p=x(null),k=x(null),g=x(null),b=x(null),S=x(null),_=x(null),R=x(null),y=$e({backtestTrade:!1,backtestAccount:!1,backtestProfit:!1,backtestPosition:!1,backtestData:!1,factorList:!1,factorAnalysisResult:!1,backtestList:!1,lastRunId:!1,backtestLastRunId:!1,factorLastDateData:!1}),v=$e({backtestTrade:null,backtestAccount:null,backtestProfit:null,backtestPosition:null,backtestData:null,factorList:null,factorAnalysisResult:null,backtestList:null,lastRunId:null,backtestLastRunId:null,factorLastDateData:null}),M=()=>{const E=localStorage.getItem("token");if(!E)throw new Error("认证令牌未找到");return E};return{log_workflow_id:e,log_workflow_run_id:t,klineChartRef:n,currentFootTab:s,child_currentFootTab:a,rightTableData:r,backtestTrade:u,backtestAccount:d,backtestProfit:p,backtestPosition:k,backtestData:g,factorList:b,factorAnalysisResult:S,backtestList:_,factorLastDateData:R,loading:y,error:v,timeRange:i,startDate:l,endDate:h,getToken:M,fetchBacktestTrade:async(E,m=1,A=10)=>{y.backtestTrade=!0,v.backtestTrade=null;try{const w=M(),L=`${ct}/api/backtest/trade?back_id=${E}&page=${m}&page_size=${A}`,j=await fetch(L,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${w}`}});if(!j.ok)throw new Error(`HTTP 错误! 状态: ${j.status}`);return u.value=await j.json(),u.value}catch(w){throw console.error("获取回测交易数据失败:",w),v.backtestTrade=w instanceof Error?w:new Error(String(w)),w}finally{y.backtestTrade=!1}},fetchBacktestAccount:async(E,m=1,A=10)=>{y.backtestAccount=!0,v.backtestAccount=null;try{const w=M(),L=`${ct}/api/backtest/account?back_id=${E}&page=${m}&page_size=${A}`,j=await fetch(L,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${w}`}});if(!j.ok)throw new Error(`HTTP 错误! 状态: ${j.status}`);return d.value=await j.json(),d.value}catch(w){throw console.error("获取回测账户数据失败:",w),v.backtestAccount=w instanceof Error?w:new Error(String(w)),w}finally{y.backtestAccount=!1}},fetchBacktestProfit:async E=>{y.backtestProfit=!0,v.backtestProfit=null;try{const m=M(),A=`${ct}/api/backtest/profit?back_id=${E}&page_size=10000`,w=await fetch(A,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${m}`}});if(!w.ok)throw new Error(`HTTP 错误! 状态: ${w.status}`);return p.value=await w.json(),p.value}catch(m){throw console.error("获取回测收益数据失败:",m),v.backtestProfit=m instanceof Error?m:new Error(String(m)),m}finally{y.backtestProfit=!1}},fetchBacktestPosition:async(E,m=1,A=10,w)=>{y.backtestPosition=!0,v.backtestPosition=null;try{const L=M(),j=`${ct}/api/backtest/position/?back_id=${E}&page=${m}&page_size=${A}&date=${w}`,K=await fetch(j,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${L}`}});if(!K.ok)throw new Error(`HTTP 错误! 状态: ${K.status}`);return k.value=await K.json(),k.value}catch(L){throw console.error("获取回测持仓数据失败:",L),v.backtestPosition=L instanceof Error?L:new Error(String(L)),L}finally{y.backtestPosition=!1}},fetchBacktestData:async E=>{y.backtestData=!0,v.backtestData=null;try{const m=M(),A=`${ct}/api/backtest/backtest?back_id=${E}`,w=await fetch(A,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${m}`}});if(!w.ok)throw new Error(`HTTP 错误! 状态: ${w.status}`);return g.value=await w.json(),g.value}catch(m){throw console.error("获取回测单一数据失败:",m),v.backtestData=m instanceof Error?m:new Error(String(m)),m}finally{y.backtestData=!1}},fetchFactorList:async(E=1,m=100,A="factor")=>{y.factorList=!0,v.factorList=null;try{const w=M(),L=`${ct}/api/workflow/all?page=${E}&limit=${m}&filter=${A}`,j=await fetch(L,{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${w}`}});if(!j.ok)throw new Error(`HTTP 错误! 状态: ${j.status}`);return b.value=await j.json(),b.value}catch(w){throw console.error("获取因子列表失败:",w),v.factorList=w instanceof Error?w:new Error(String(w)),w}finally{y.factorList=!1}},fetchFactorAnalysisResult:async E=>{y.factorAnalysisResult=!0,v.factorAnalysisResult=null;try{const m=M(),A=`${ct}/api/workflow/run/output?output_obj_id=${E}`,w=await fetch(A,{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${m}`}});if(!w.ok)throw new Error(`HTTP 错误! 状态: ${w.status}`);return S.value=await w.json(),S.value}catch(m){throw console.error("获取因子分析结果失败:",m),v.factorAnalysisResult=m instanceof Error?m:new Error(String(m)),m}finally{y.factorAnalysisResult=!1}},fetchBacktestList:async(E=1,m=100,A="backtest")=>{y.backtestList=!0,v.backtestList=null;try{const w=M(),L=`${ct}/api/workflow/all?page=${E}&limit=${m}&filter=${A}`,j=await fetch(L,{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${w}`}});if(!j.ok)throw new Error(`HTTP 错误! 状态: ${j.status}`);return _.value=await j.json(),_.value}catch(w){throw console.error("获取策略回测列表失败:",w),v.backtestList=w instanceof Error?w:new Error(String(w)),w}finally{y.backtestList=!1}},fetchLastRunId:async(E,m,A)=>{y.lastRunId=!0,v.lastRunId=null;try{const w=M(),L=`${ct}/api/workflow/run/output/by-last-run?workflow_id=${E}&feature_tag=${m}&locator=${A}`,j=await fetch(L.toString(),{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${w}`}});if(!j.ok)throw new Error(`HTTP 错误! 状态: ${j.status}`);return await j.json()}catch(w){throw console.error("获取因子列表最后运行ID失败:",w),v.lastRunId=w instanceof Error?w:new Error(String(w)),w}finally{y.lastRunId=!1}},fetchBacktestLastRunId:async(E,m,A)=>{y.backtestLastRunId=!0,v.backtestLastRunId=null;try{const w=M(),L=`${ct}/api/workflow/run/output/by-last-run?workflow_id=${E}&feature_tag=${m}&locator=${A}`,j=await fetch(L.toString(),{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${w}`}});if(!j.ok)throw new Error(`HTTP 错误! 状态: ${j.status}`);return await j.json()}catch(w){throw console.error("获取回测列表最后运行ID失败:",w),v.backtestLastRunId=w instanceof Error?w:new Error(String(w)),w}finally{y.backtestLastRunId=!1}},getFactorEarnings:async E=>{try{const m=await fetch(`${Gt}/api/v1/query_one_group_data?task_id=${E}`);if(!(m!=null&&m.ok))throw new Error("请求失败：未收到响应");return await m.json()}catch(m){throw m}},getFactorEarningsChart:async E=>{try{const m=await fetch(`${Gt}/api/v1/query_simple_return_chart?task_id=${E}`);if(!(m!=null&&m.ok))throw new Error("请求失败：未收到响应");return await m.json()}catch(m){throw m}},getFactorLastDateData:async E=>{var m,A;y.factorLastDateData=!0,v.factorLastDateData=null;try{const w=localStorage.getItem("token"),L=localStorage.getItem("userid"),j=await fetch(`${Gt}/api/v1/query_last_date_top_factor?task_id=${E}`,{headers:{Authorization:`${w}`,userId:`${L}`,"Content-Type":"application/json"}});if(!(j!=null&&j.ok))throw new Error("请求失败：未收到响应");const K=await j.json();return(A=(m=K.data)==null?void 0:m.last_date_top_factor)==null||A.forEach(it=>{it.code=it.symbol.split(".")[1]}),R.value=K,K}catch(w){throw console.error("获取因子最新日期数据失败:",w),v.factorLastDateData=w instanceof Error?w:new Error(String(w)),w}finally{y.factorLastDateData=!1}},updateTimeRange:(E,m,A)=>{i.value=E,l.value=m,h.value=A}}}),ma={class:"table-container"},wa={class:"table-wrapper"},va={class:"custom-table"},_a=["title"],ka={class:"name-cell table-cell"},Ea=["onBlur","onKeyup"],Sa=["title"],Ta=["onClick"],Ca={class:"table-cell"},Ra={class:"table-cell"},xa={style:{"text-align":"right"}},$a=["onClick"],Aa=["onClick"],Da={key:0,class:"loading-spinner"},Pa={class:"pagination"},La={class:"page-nav"},Oa=["disabled"],Fa={style:{transform:"rotate(180deg)"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"32302",width:"16",height:"16"},ja={key:0,class:"dots"},Na=["onClick"],Ba=["disabled"],Ia={style:{transform:"rotate(0deg)"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"32302",width:"16",height:"16"},qa={__name:"tablea",props:{tableData:{type:Array,default:()=>[]}},emits:["apply"],setup(e,{expose:t,emit:n}){const s=Ge(),a=n,r=kt(),i=kn(),l=C=>{i.push(`/editor?workflow_id=${C}`)};x(!1);const h=x(null),u=x(""),d=e,p=ft(()=>!d.tableData||!d.tableData.data||!d.tableData.data.workflows?[]:d.tableData.data.workflows.map(C=>({id:C._id,name:C.name,createTime:Ve(C.create_at),modifyTime:Ve(C.update_at),item:C}))),k=x([]);rt(p,C=>{k.value=C},{immediate:!0});const g=x(1),b=x(10),S=ft(()=>k.value.length),_=ft(()=>Math.ceil(S.value/b.value)),R=ft(()=>{const C=(g.value-1)*b.value,P=C+b.value;return k.value.slice(C,P)}),y=ft(()=>{const C=[],P=_.value,$=g.value;if(P<=5){for(let H=1;H<=P;H++)C.push(H);return C}if(C.push(1),$>3&&C.push("..."),$===1||$===2)C.includes(2)||C.push(2),C.includes(3)||C.push(3);else if($===P||$===P-1)for(let H=P-2;H<P;H++)C.includes(H)||C.push(H);else C.push($-1,$,$+1);return $<P-2&&C.push("..."),C.includes(P)||C.push(P),[...new Set(C)]}),v=C=>{C!=="..."&&(g.value=C)},M=()=>{g.value>1&&g.value--},U=()=>{g.value<_.value&&g.value++},G=x(null),Q=async C=>{var P;h.value=C.id,u.value=C.name,await Tn(),(P=G.value)==null||P.focus()},T=async C=>{if(!u.value.trim()){s.error("名称不能为空"),u.value=C.name;return}if(u.value===C.name){h.value=null;return}try{await $n(C.id,u.value);const P=k.value.findIndex($=>$.id===C.id);P!==-1&&(k.value[P].name=u.value),h.value=null,s.success("名称修改成功")}catch(P){console.error("重命名失败:",P),u.value=C.name,s.error("名称修改失败，请稍后重试")}},f=()=>{h.value=null,u.value=""},O=x({}),F=(C,P)=>{O.value[P]=!0,r.log_workflow_id=C._id,r.log_workflow_run_id=C.last_run_id,a("apply",{workflow_id:C._id,title:C.name,feature_tag:"backtest",locator:"backtest_id",last_run_id:C.last_run_id}),setTimeout(()=>{O.value[P]=!1},5e3),console.log("应用项目1：",C)},W=C=>{C?O.value[C]=!1:Object.keys(O.value).forEach(P=>{O.value[P]=!1})};return rt(p,()=>{W()},{deep:!0}),t({resetLoadingState:W}),(C,P)=>(N(),B("div",ma,[o("div",wa,[o("table",va,[P[2]||(P[2]=o("thead",null,[o("tr",null,[o("th",null,"ID"),o("th",null,"名称"),o("th",null,"创建时间"),o("th",null,"修改时间"),o("th")])],-1)),o("tbody",null,[(N(!0),B(at,null,ht(R.value,($,H)=>(N(),B("tr",{key:$.id},[o("td",{class:"table-cell",title:$.id},I($.id),9,_a),o("td",ka,[h.value===$.id?pt((N(),B("input",{key:0,"onUpdate:modelValue":P[0]||(P[0]=Y=>u.value=Y),type:"text",class:"edit-input",onBlur:Y=>T($),onKeyup:[Ae(Y=>T($),["enter"]),Ae(f,["esc"])],ref_for:!0,ref_key:"editInput",ref:G},null,40,Ea)),[[En,u.value]]):(N(),B(at,{key:1},[o("span",{class:"table-cell",title:$.name},I($.name),9,Sa),$.owner!=="*"?(N(),B("span",{key:0,class:"copy-icon",onClick:Y=>Q($)},P[1]||(P[1]=[Sn('<svg width="12px" height="12px" viewBox="0 0 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" data-v-30298d29><title data-v-30298d29>修改名称</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" data-v-30298d29><g id="超级图表-工作流" transform="translate(-364, -729)" fill="#2767EE" fill-rule="nonzero" data-v-30298d29><g id="编辑" transform="translate(364, 729)" data-v-30298d29><path d="M5.98554217,5.31036145 L10.9359036,0.361445783 C11.1310843,0.16626506 11.4477108,0.16626506 11.6428916,0.361445783 C11.8380723,0.556626506 11.8380723,0.873253012 11.6428916,1.06843373 L6.69253012,6.0173494 C6.4973494,6.21253012 6.18072289,6.21253012 5.98554217,6.0173494 C5.79036145,5.82216867 5.79036145,5.50554217 5.98554217,5.31036145 Z M10.9995181,5.83373494 C10.9995181,5.55759036 11.2236145,5.33349398 11.499759,5.33349398 C11.7759036,5.33349398 12,5.55759036 12,5.83373494 L12,9.50024096 C12,10.8809639 10.8809639,12 9.50024096,12 L2.49975904,12 C1.11903614,12 0,10.8809639 0,9.50024096 L0,2.49975904 C0,1.11903614 1.11903614,0 2.49975904,0 L6.16626506,0 C6.44240964,0 6.66650602,0.224096386 6.66650602,0.500240964 C6.66650602,0.776385542 6.44240964,1.00048193 6.16626506,1.00048193 L2.49975904,1.00048193 C1.6713253,1.00048193 1.00048193,1.67277108 1.00048193,2.49975904 L1.00048193,9.50024096 C1.00048193,10.3286747 1.67277108,11.0009639 2.49975904,11.0009639 L9.50024096,11.0009639 C10.3286747,11.0009639 11.0009639,10.3286747 11.0009639,9.50024096 L11.0009639,5.83373494 L10.9995181,5.83373494 Z" id="形状" data-v-30298d29></path></g></g></g></svg>',1)]),8,Ta)):dt("",!0)],64))]),o("td",Ca,I($.createTime),1),o("td",Ra,I($.modifyTime),1),o("td",xa,[o("button",{class:z(["apply-btn"]),onClick:Y=>l($.id),style:{"margin-right":"10px"}}," 编辑 ",8,$a),o("button",{class:z(["apply-btn",{loading:O.value[$.id]}]),onClick:Y=>F($.item,$.id)},[wt(I(O.value[$.id]?"正在应用":"应用")+" ",1),O.value[$.id]?(N(),B("span",Da)):dt("",!0)],10,Aa)])]))),128))])])]),o("div",Pa,[o("div",La,[o("button",{disabled:g.value===1,onClick:M},[(N(),B("svg",Fa,P[3]||(P[3]=[o("path",{"data-v-da8ede72":"",d:"M722.438 510.815c-0.246-0.246-0.513-0.454-0.766-0.69l-299.893-299.892c-14.231-14.24-37.291-14.24-51.529 0-14.241 14.231-14.241 37.291 0 51.529l274.851 274.859-274.849 274.851c-14.241 14.237-14.241 37.301 0 51.532 7.116 7.119 16.436 10.682 25.764 10.682 9.321 0 18.644-3.563 25.763-10.682l299.905-299.901c0.246-0.234 0.51-0.438 0.751-0.678 7.129-7.13 10.685-16.469 10.674-25.804 0.006-9.337-3.55-18.676-10.674-25.804z",fill:"#ffffff","p-id":"32303"},null,-1)])))],8,Oa),(N(!0),B(at,null,ht(y.value,($,H)=>(N(),B(at,{key:H},[$==="..."?(N(),B("span",ja,"...")):(N(),B("button",{key:1,class:z({active:$===g.value}),onClick:Y=>v($)},I($),11,Na))],64))),128)),o("button",{disabled:g.value===_.value,onClick:U},[(N(),B("svg",Ia,P[4]||(P[4]=[o("path",{"data-v-da8ede72":"",d:"M722.438 510.815c-0.246-0.246-0.513-0.454-0.766-0.69l-299.893-299.892c-14.231-14.24-37.291-14.24-51.529 0-14.241 14.231-14.241 37.291 0 51.529l274.851 274.859-274.849 274.851c-14.241 14.237-14.241 37.301 0 51.532 7.116 7.119 16.436 10.682 25.764 10.682 9.321 0 18.644-3.563 25.763-10.682l299.905-299.901c0.246-0.234 0.51-0.438 0.751-0.678 7.129-7.13 10.685-16.469 10.674-25.804 0.006-9.337-3.55-18.676-10.674-25.804z",fill:"#ffffff","p-id":"32303"},null,-1)])))],8,Ba)])])]))}},Ua=bt(qa,[["__scopeId","data-v-30298d29"]]),Ma={class:"modal-content"},za={class:"modal-header"},Ha={class:"tabs"},Va={class:"toolbar"},Ga={class:"checkbox-group"},Ja={class:"custom-checkbox"},Wa={class:"custom-checkbox"},Ya={class:"custom-checkbox"},Ka={class:"custom-checkbox"},Xa={class:"log-viewer"},Za={class:"log-content"},Qa={class:"timestamp"},tr={class:"level"},er={class:"message"},nr={class:"placeholder-content"},sr={class:"placeholder-content"},ar={__name:"logs",setup(e,{expose:t}){const n=kt(),s=async(R=!1,y="")=>{try{if(!n.log_workflow_run_id||!n.log_workflow_id)return null;const v=localStorage.getItem("token"),M={workflow_run_id:n.log_workflow_run_id,workflow_id:n.log_workflow_id,limit:100};R&&(M.last_sequence=R),y&&(M.log_level=y);const U=await J.get("http://localhost:8000/api/workflow/run/log",{params:M,headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:v}});return U.data&&U.data.code===0&&U.data.data&&U.data.data.logs?(g.value=U.data.data.logs.map(G=>({timestamp:new Date(G.timestamp).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),level:G.level,message:G.message,work_node_id:G.work_node_id,sequence:G.sequence})),{hasMore:U.data.data.has_more,nextLogId:U.data.data.next_log_id,nextSequence:U.data.data.next_sequence,totalCount:U.data.data.total_count}):null}catch(v){return console.error("Failed to fetch logs:",v),null}},a=async()=>{try{const R=await s(!1,"");R&&console.log("Page info:",R)}catch(R){console.error("Failed to refresh logs:",R)}};let r=null;const i=()=>{r||(r=setInterval(a,5e3))},l=()=>{r&&(clearInterval(r),r=null)};Ct(()=>{a(),i()}),Je(()=>{l()});const h=[{label:"日志",value:"logs"}],u=x("logs"),d=R=>{console.log("当前选中的tab:",R),u.value=R},p=x(!1),k=x(["INFO","WARN","DEBUG","ERROR"]),g=x([{timestamp:"2025-06-04 13:30:01",level:"ERROR",message:"多头持仓"},{timestamp:"2025-06-04 13:30:01",level:"INFO",message:"当前无仓位需要进行调整"},{timestamp:"2025-06-04 13:30:01",level:"INFO",message:"开始进行批量下单"},{timestamp:"2025-06-04 13:30:01",level:"ERROR",message:"按目标调仓"},{timestamp:"2025-06-04 13:30:01",level:"WARN",message:"[{'AL2507.SHF': 4.0, 'AU2508.SHF': 2.0, 'BU2507.SHF': 6.0, 'CU2507.SHF': 1.0, 'IF2509.CFE': 1.0, 'IH2509.CFE': 1.0, 'L2509.DCE': 9.0, 'RU2509.SHF': 2.0, 'T2509.CFE': 2.0, 'TF2509.CFE': 4.0, 'TL2509.CFE': 1.0, 'TS2509.CFE': 5.0, 'ZN2507.SHF': 3.0}]"},{timestamp:"2025-06-04 13:30:01",level:"ERROR",message:"无对冲信号"}]),b=ft(()=>g.value.filter(R=>k.value.includes(R.level))),S=()=>{p.value=!0,i()},_=()=>{p.value=!1,l()};return t({openDialog:S,closeDialog:_}),(R,y)=>p.value?(N(),B("div",{key:0,class:"modal-overlay",onClick:Cn(_,["self"])},[o("div",Ma,[o("div",za,[o("div",Ha,[ut(vn,{"tab-list":h,tab:u.value,"onUpdate:tab":[y[0]||(y[0]=v=>u.value=v),d]},null,8,["tab"])]),o("div",Va,[o("div",Ga,[o("label",Ja,[pt(o("input",{type:"checkbox",value:"INFO","onUpdate:modelValue":y[1]||(y[1]=v=>k.value=v)},null,512),[[$t,k.value]]),y[5]||(y[5]=o("span",{class:"checkmark"},null,-1)),y[6]||(y[6]=wt(" INFO "))]),o("label",Wa,[pt(o("input",{type:"checkbox",value:"WARN","onUpdate:modelValue":y[2]||(y[2]=v=>k.value=v)},null,512),[[$t,k.value]]),y[7]||(y[7]=o("span",{class:"checkmark"},null,-1)),y[8]||(y[8]=wt(" WARN "))]),o("label",Ya,[pt(o("input",{type:"checkbox",value:"DEBUG","onUpdate:modelValue":y[3]||(y[3]=v=>k.value=v)},null,512),[[$t,k.value]]),y[9]||(y[9]=o("span",{class:"checkmark"},null,-1)),y[10]||(y[10]=wt(" DEBUG "))]),o("label",Ka,[pt(o("input",{type:"checkbox",value:"ERROR","onUpdate:modelValue":y[4]||(y[4]=v=>k.value=v)},null,512),[[$t,k.value]]),y[11]||(y[11]=o("span",{class:"checkmark"},null,-1)),y[12]||(y[12]=wt(" ERROR "))])]),o("button",{class:"button",onClick:a,style:{border:"0"}},y[13]||(y[13]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round",class:"refresh-icon"},[o("path",{d:"M23 4v6h-6"}),o("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})],-1),wt(" 刷新 ")]))]),o("button",{class:"close-button",onClick:_},"×")]),pt(o("div",Xa,[o("div",Za,[(N(!0),B(at,null,ht(b.value,(v,M)=>(N(),B("div",{key:M,class:z(["log-entry",v.level.toLowerCase()])},[o("span",Qa,"["+I(v.timestamp)+"]",1),o("span",tr,"-"+I(v.level)+"-",1),o("span",er,I(v.message),1)],2))),128))])],512),[[Mt,u.value==="logs"]]),pt(o("div",nr," 风控日志内容... ",512),[[Mt,u.value==="risk"]]),pt(o("div",sr," 错误日志内容... ",512),[[Mt,u.value==="errors"]])])])):dt("",!0)}},rr=bt(ar,[["__scopeId","data-v-7de486e1"]]),or={class:"chart-container"},ir={class:"header"},lr={class:"metrics"},cr={class:"metric"},ur={class:"metric"},dr={class:"metric"},fr={class:"metric"},pr={class:"metric"},hr={class:"metric"},br={class:"metric"},gr={class:"metric"},yr={class:"metric"},mr={class:"metric"},wr={class:"metric"},vr={class:"chart-box"},_r={class:"time-controls"},kr={class:"time-buttons"},Er={class:"date-picker"},Sr={class:"date-picker"},Tr={class:"chart-legend"},Cr={__name:"aa",props:{back_id:{type:String,required:!0}},setup(e){const t=kt(),n=e,s=x(null);let a=null,r=null;const i=x("month"),l=x(""),h=x(""),u=x(1),d=x(10),p=x([]),k=x(new Set),g=x({strategyProfit:!0,benchmarkProfit:!0,excessProfit:!0,dayProfit:!0,dayTrade:!0}),b=T=>{g.value[T]=!g.value[T],G()};ft(()=>{const T=parseInt(u.value);return T===1?"日":T===2?"2日":T===3?"3日":T===5?"周":T===10?"2周":`${T}日`});const S=T=>{if(typeof T=="string"&&T.length===8)return`${T.slice(0,4)}-${T.slice(4,6)}-${T.slice(6,8)}`;if(T instanceof Date){const f=T.getFullYear(),O=String(T.getMonth()+1).padStart(2,"0"),F=String(T.getDate()).padStart(2,"0");return`${f}-${O}-${F}`}if(typeof T=="number"){const f=new Date(T);return S(f)}return""},_=T=>{if(!T||!k.value.size)return!1;const f=S(T);return console.log("Checking date:",f,"Available:",k.value.has(f)),!k.value.has(f)};rt(()=>n.back_id,async()=>{var T,f;if(n.back_id&&(console.log("回测数据back_id：",n.back_id),await t.fetchBacktestData(n.back_id),console.log("回测数据：",t.backtestData),await t.fetchBacktestProfit(n.back_id),console.log("回测收益数据：",t.backtestProfit),(f=(T=t.backtestProfit)==null?void 0:T.data)!=null&&f.items)){if(p.value=t.backtestProfit.data.items,console.log("Sample date format:",{firstItem:p.value[0],dateType:typeof p.value[0].gmt_create,dateValue:p.value[0].gmt_create}),k.value=new Set(p.value.map(O=>S(O.gmt_create))),console.log("Available dates:",Array.from(k.value)),p.value.length>0){const O=Array.from(k.value).sort();l.value=O[0],h.value=O[O.length-1],console.log("Set date range:",{start:l.value,end:h.value})}G()}},{immediate:!0}),rt([l,h],([T,f])=>{T&&f&&(t.updateTimeRange(i.value,T,f),G())},{immediate:!0});const R=(T,f=!1,O=2)=>T==null?f?"0.00%":"0.0000":f?(T*100).toFixed(O)+"%":T.toFixed(O),y=T=>T>0?"positive":T<0?"negative":"",v=T=>{if(i.value=T,!p.value||p.value.length===0)return;const f=p.value.map(C=>S(C.gmt_create)),O=f[f.length-1],F=new Date(O);let W=new Date(O);switch(T){case"month":W.setMonth(F.getMonth()-1);break;case"quarter":W.setMonth(F.getMonth()-3);break;case"halfYear":W.setMonth(F.getMonth()-6);break;case"year":W.setFullYear(F.getFullYear()-1);break;case"ytd":W=new Date(F.getFullYear(),0,1);break;case"all":W=new Date(f[0]);break}l.value=W.toISOString().split("T")[0],h.value=O,t.updateTimeRange(T,l.value,h.value),G()},M=()=>{t.updateTimeRange(i.value,l.value,h.value),G()},U=(T,f)=>{if(f<=1||!T||T.length===0)return T;const O=[];let F=[];return T.forEach((W,C)=>{if(C%f===0&&C!==0){const P={gmt_create:F[0].gmt_create,gmt_create_time:F[0].gmt_create_time,strategy_profit:F[F.length-1].strategy_profit,csi_stock:F[F.length-1].csi_stock,overful_profit:F[F.length-1].overful_profit,day_profit:F.reduce(($,H)=>$+H.day_profit,0),day_purchase:F.reduce(($,H)=>$+H.day_purchase,0),day_put:F.reduce(($,H)=>$+H.day_put,0)};O.push(P),F=[]}if(F.push(W),C===T.length-1&&F.length>0){const P={gmt_create:F[0].gmt_create,gmt_create_time:F[0].gmt_create_time,strategy_profit:F[F.length-1].strategy_profit,csi_stock:F[F.length-1].csi_stock,overful_profit:F[F.length-1].overful_profit,day_profit:F.reduce(($,H)=>$+H.day_profit,0),day_purchase:F.reduce(($,H)=>$+H.day_purchase,0),day_put:F.reduce(($,H)=>$+H.day_put,0)};O.push(P)}}),O},G=()=>{if(!s.value||!p.value||p.value.length===0)return;let T=p.value;l.value&&h.value&&(T=p.value.filter(E=>{const m=S(E.gmt_create);return m>=l.value&&m<=h.value}));const f=parseInt(u.value),O=U(T,f),F=O.map(E=>S(E.gmt_create)),W=O.map(E=>E.strategy_profit*100),C=O.map(E=>E.csi_stock*100),P=O.map(E=>E.overful_profit*100),$=O.map(E=>({value:Math.abs(E.day_profit),itemStyle:{color:E.day_profit>=0?"#2dc08e":"#f92855"}})),H=O.map(E=>({value:Math.max(Math.abs(E.day_purchase),Math.abs(E.day_put)),itemStyle:{color:E.day_purchase>0?"#2dc08e":"#f92855"}})),Y=[];g.value.strategyProfit&&Y.push({name:"策略收益",type:"line",symbol:"none",data:W,lineStyle:{color:"#29a5ff"},itemStyle:{color:"#29a5ff"}}),g.value.benchmarkProfit&&Y.push({name:"基准收益",type:"line",symbol:"none",data:C,lineStyle:{color:"#38B6B6"},itemStyle:{color:"#38B6B6"}}),g.value.excessProfit&&Y.push({name:"超额收益",type:"line",symbol:"none",data:P,lineStyle:{color:"#9D4EDD"},itemStyle:{color:"#9D4EDD"}}),g.value.dayProfit&&Y.push({name:"当日盈亏",type:"bar",xAxisIndex:1,yAxisIndex:1,data:$}),g.value.dayTrade&&Y.push({name:"当日买卖",type:"bar",xAxisIndex:1,yAxisIndex:1,barGap:"30%",data:H});const D={backgroundColor:"#14151A",tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(E){let m=E[0].axisValue+"<br/>";return E.forEach(A=>{let w=A.color;typeof w!="string"&&(w=A.color.colorStops?A.color.colorStops[0].color:"#fff");let L=A.value;if(A.seriesName==="策略收益"||A.seriesName==="基准收益"||A.seriesName==="超额收益")L=L.toFixed(4)+"%";else if(A.seriesName==="当日盈亏"){const j=A.dataIndex;L=O[j].day_profit.toFixed(2)}else if(A.seriesName==="当日买卖"){const j=A.dataIndex,K=O[j].day_purchase,it=O[j].day_put;L=`买入: ${K}, 卖出: ${it}`}m+=`<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${w};"></span> ${A.seriesName}: ${L}<br/>`}),m}},grid:[{left:"6%",right:"6%",height:"50%",top:"5%"},{left:"6%",right:"6%",top:"65%",height:"25%",bottom:"10%"}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",bottom:"2%",height:15,start:0,end:100,handleSize:10}],xAxis:[{type:"category",data:F,axisLine:{lineStyle:{color:"#333"}},axisLabel:{color:"#999"}},{gridIndex:1,type:"category",data:F,axisLine:{lineStyle:{color:"#333"}},axisLabel:{color:"#999",showMaxLabel:!0}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:"#333"}},axisLabel:{color:"#999",formatter:"{value}%"},splitLine:{lineStyle:{color:"#222"}}},{gridIndex:1,type:"value",axisLine:{lineStyle:{color:"#333"}},axisLabel:{color:"#999"},splitLine:{lineStyle:{color:"#222"}}}],series:Y};a||(a=De(s.value),window.addEventListener("resize",()=>{a&&a.resize()})),a.setOption(D,!0)},Q=()=>{const T=document.querySelectorAll('[id^="el-popper-container-"]');console.log("找到popper元素数量:",T.length),T.forEach(f=>{f.style.position="relative",f.style.zIndex="99999999999999999",console.log(`已设置元素 ${f.id} 的样式`)})};return Ct(async()=>{var T,f;if(n.back_id&&(await t.fetchBacktestData(n.back_id),await t.fetchBacktestProfit(n.back_id),(f=(T=t.backtestProfit)==null?void 0:T.data)!=null&&f.items)){if(p.value=t.backtestProfit.data.items,p.value.length>0){const O=p.value.map(F=>S(F.gmt_create));l.value=O[0],h.value=O[O.length-1],d.value=Math.min(Math.floor(p.value.length/2),20)}v("all")}Q(),a=De(s.value),r=new ResizeObserver(()=>{a==null||a.resize()}),s.value&&r.observe(s.value)}),Je(()=>{r&&r.disconnect(),a&&(a.dispose(),a=null)}),(T,f)=>{var F,W,C,P,$,H,Y,D,E,m,A,w,L,j,K,it,Et,nt,se,ae,re,oe,ie,le,ce,ue,de,fe,pe,he,be,ge,ye,me,we,ve,_e,ke,Ee,Se,Te,Ce,Re,xe;const O=Rn("el-date-picker");return N(),B("div",or,[o("div",ir,[o("div",lr,[o("div",cr,[f[12]||(f[12]=o("span",{class:"label"},"收益",-1)),o("span",{class:z(["value",y((W=(F=V(t).backtestData)==null?void 0:F.data)==null?void 0:W.back_profit)])},I(R((P=(C=V(t).backtestData)==null?void 0:C.data)==null?void 0:P.back_profit,!0)),3)]),o("div",ur,[f[13]||(f[13]=o("span",{class:"label"},"年化收益",-1)),o("span",{class:z(["value",y((H=($=V(t).backtestData)==null?void 0:$.data)==null?void 0:H.back_profit_year)])},I(R((D=(Y=V(t).backtestData)==null?void 0:Y.data)==null?void 0:D.back_profit_year,!0)),3)]),o("div",dr,[f[14]||(f[14]=o("span",{class:"label"},"基准收益",-1)),o("span",{class:z(["value",y((m=(E=V(t).backtestData)==null?void 0:E.data)==null?void 0:m.benchmark_profit)])},I(R((w=(A=V(t).backtestData)==null?void 0:A.data)==null?void 0:w.benchmark_profit,!0)),3)]),o("div",fr,[f[15]||(f[15]=o("span",{class:"label"},"信息比率",-1)),o("span",{class:z(["value",y((j=(L=V(t).backtestData)==null?void 0:L.data)==null?void 0:j.information_ratio)])},I(R((it=(K=V(t).backtestData)==null?void 0:K.data)==null?void 0:it.information_ratio,!1,4)),3)]),o("div",pr,[f[16]||(f[16]=o("span",{class:"label"},"夏普比率",-1)),o("span",{class:z(["value",y((nt=(Et=V(t).backtestData)==null?void 0:Et.data)==null?void 0:nt.sharpe)])},I(R((ae=(se=V(t).backtestData)==null?void 0:se.data)==null?void 0:ae.sharpe,!1,4)),3)]),o("div",hr,[f[17]||(f[17]=o("span",{class:"label"},"Alpha",-1)),o("span",{class:z(["value",y((oe=(re=V(t).backtestData)==null?void 0:re.data)==null?void 0:oe.alpha)])},I(R((le=(ie=V(t).backtestData)==null?void 0:ie.data)==null?void 0:le.alpha,!1,4)),3)]),o("div",br,[f[18]||(f[18]=o("span",{class:"label"},"Beta",-1)),o("span",{class:z(["value",y((ue=(ce=V(t).backtestData)==null?void 0:ce.data)==null?void 0:ue.beta)])},I(R((fe=(de=V(t).backtestData)==null?void 0:de.data)==null?void 0:fe.beta,!1,4)),3)]),o("div",gr,[f[19]||(f[19]=o("span",{class:"label"},"Sortino(索提诺比率)",-1)),o("span",{class:z(["value",y((he=(pe=V(t).backtestData)==null?void 0:pe.data)==null?void 0:he.sortino)])},I(R((ge=(be=V(t).backtestData)==null?void 0:be.data)==null?void 0:ge.sortino,!1,4)),3)]),o("div",yr,[f[20]||(f[20]=o("span",{class:"label"},"收益波动率",-1)),o("span",{class:z(["value",y((me=(ye=V(t).backtestData)==null?void 0:ye.data)==null?void 0:me.volatility)])},I(R((ve=(we=V(t).backtestData)==null?void 0:we.data)==null?void 0:ve.volatility,!0,2)),3)]),o("div",mr,[f[21]||(f[21]=o("span",{class:"label"},"最大回撤",-1)),o("span",{class:z(["value",y((ke=(_e=V(t).backtestData)==null?void 0:_e.data)==null?void 0:ke.max_drawdown)])},I(R((Se=(Ee=V(t).backtestData)==null?void 0:Ee.data)==null?void 0:Se.max_drawdown,!0,2)),3)]),o("div",wr,[f[22]||(f[22]=o("span",{class:"label"},"下行风险",-1)),o("span",{class:z(["value",y((Ce=(Te=V(t).backtestData)==null?void 0:Te.data)==null?void 0:Ce.downside_risk)])},I(R((xe=(Re=V(t).backtestData)==null?void 0:Re.data)==null?void 0:xe.downside_risk,!0,2)),3)])])]),o("div",vr,[o("div",_r,[o("div",kr,[o("button",{class:z({active:i.value==="month"}),onClick:f[0]||(f[0]=st=>v("month"))},"月",2),o("button",{class:z({active:i.value==="quarter"}),onClick:f[1]||(f[1]=st=>v("quarter"))},"季度",2),o("button",{class:z({active:i.value==="halfYear"}),onClick:f[2]||(f[2]=st=>v("halfYear"))},"半年",2),o("button",{class:z({active:i.value==="year"}),onClick:f[3]||(f[3]=st=>v("year"))},"年",2),o("button",{class:z({active:i.value==="all"}),onClick:f[4]||(f[4]=st=>v("all"))},"全部",2),o("div",Er,[f[23]||(f[23]=o("span",null,"开始时间",-1)),ut(O,{class:"date-picker-input-ns",modelValue:l.value,"onUpdate:modelValue":f[5]||(f[5]=st=>l.value=st),type:"date",placeholder:"选择开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:M,"disabled-date":_,size:"small"},null,8,["modelValue"])]),o("div",Sr,[f[24]||(f[24]=o("span",null,"结束时间",-1)),ut(O,{class:"date-picker-input-ns",modelValue:h.value,"onUpdate:modelValue":f[6]||(f[6]=st=>h.value=st),type:"date",placeholder:"选择结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:M,"disabled-date":_,size:"small"},null,8,["modelValue"])])]),o("div",Tr,[o("div",{class:z(["legend-item",{inactive:!g.value.strategyProfit}]),onClick:f[7]||(f[7]=st=>b("strategyProfit"))},f[25]||(f[25]=[o("span",{class:"line-icon strategy-line"},null,-1),o("span",{class:"legend-text"},"策略收益",-1)]),2),o("div",{class:z(["legend-item",{inactive:!g.value.excessProfit}]),onClick:f[8]||(f[8]=st=>b("excessProfit"))},f[26]||(f[26]=[o("span",{class:"line-icon excess-line"},null,-1),o("span",{class:"legend-text"},"超额收益",-1)]),2),o("div",{class:z(["legend-item",{inactive:!g.value.benchmarkProfit}]),onClick:f[9]||(f[9]=st=>b("benchmarkProfit"))},f[27]||(f[27]=[o("span",{class:"line-icon benchmark-line"},null,-1),o("span",{class:"legend-text"},"基准收益",-1)]),2),o("div",{class:z(["legend-item",{inactive:!g.value.dayProfit}]),onClick:f[10]||(f[10]=st=>b("dayProfit"))},f[28]||(f[28]=[o("div",{class:"square-container"},[o("span",{class:"square-icon loss-square"}),o("span",{class:"square-icon profit-square"})],-1),o("span",{class:"legend-text"},"当日盈亏",-1)]),2),o("div",{class:z(["legend-item",{inactive:!g.value.dayTrade}]),onClick:f[11]||(f[11]=st=>b("dayTrade"))},f[29]||(f[29]=[o("div",{class:"square-container"},[o("span",{class:"square-icon sell-square"}),o("span",{class:"square-icon buy-square"})],-1),o("span",{class:"legend-text"},"当日买卖",-1)]),2)])]),o("div",{ref_key:"chartRef",ref:s,class:"chart"},null,512)])])}}},Rr=bt(Cr,[["__scopeId","data-v-15ab1806"]]),xr={class:"table-container"},$r={class:"table-container-inner"},Ar={class:"data-table"},Dr={__name:"bb",props:{back_id:{type:String,required:!0},currentPage:{type:Number,default:1},pageSize:{type:Number,default:10}},emits:["update:pagination"],setup(e,{emit:t}){const n=kt(),s=e,a=t,r=x([]),i=x(1),l=x(0),h=g=>{if(!g)return"";const b=g.substring(0,4),S=g.substring(4,6),_=g.substring(6,8);return`${b}/${S}/${_}`},u=g=>{if(g==null)return"¥0.00";const b=g/100;return b<0?`-¥${Math.abs(b).toFixed(2)}`:`¥${b.toFixed(2)}`},d=g=>{switch(g){case 0:return"股票";case 1:return"期货";case 2:return"基金";default:return"未知"}},p=g=>{switch(g){case 0:return"stock";case 1:return"futures";case 2:return"fund";default:return""}},k=async()=>{try{await n.fetchBacktestTrade(s.back_id,s.currentPage,s.pageSize),n.backtestTrade&&n.backtestTrade.data&&(r.value=n.backtestTrade.data.items||[],n.backtestTrade.data.pagination&&(l.value=n.backtestTrade.data.pagination.total,i.value=n.backtestTrade.data.pagination.total_pages,a("update:pagination",{currentPage:n.backtestTrade.data.pagination.page,pageSize:n.backtestTrade.data.pagination.page_size,totalPages:i.value,totalItems:l.value})))}catch(g){console.error("获取回测交易数据失败",g)}};return rt(()=>s.back_id,()=>{k()}),rt(()=>s.currentPage,()=>{k()}),rt(()=>s.pageSize,()=>{k()}),Ct(async()=>{await k()}),(g,b)=>(N(),B("div",xr,[o("div",$r,[o("table",Ar,[b[0]||(b[0]=o("thead",null,[o("tr",null,[o("th",null,"标的"),o("th",null,"交易日期"),o("th",null,"交易类型"),o("th",null,"品种"),o("th",null,"方向"),o("th",null,"成交量"),o("th",null,"成交价格"),o("th",null,"费用")])],-1)),o("tbody",null,[(N(!0),B(at,null,ht(r.value,(S,_)=>(N(),B("tr",{key:_},[o("td",null,I(S.contract_code),1),o("td",null,I(h(S.gmt_create)),1),o("td",null,[o("span",{class:z(["trade-type",S.business===0?"buy":"sell"])},I(S.business===0?"买入":"卖出"),3)]),o("td",null,[o("span",{class:z(["product-type",p(S.type)])},I(d(S.type)),3)]),o("td",null,[o("span",{class:z(["direction",S.direction===0?"long":"short"])},I(S.direction===0?"开":"平"),3)]),o("td",null,I(Math.abs(S.volume)),1),o("td",null,I(u(S.price)),1),o("td",null,I(u(S.cost)),1)]))),128))])])])]))}},Pr=bt(Dr,[["__scopeId","data-v-ddc284ad"]]),Lr={class:"table-container"},Or={class:"table-container-inner"},Fr={class:"data-table"},jr={class:"sub-row"},Nr={class:"sub-row"},Br={class:"sub-row"},Ir={class:"sub-row"},qr={__name:"cc",props:{back_id:{type:String,required:!0},currentPage:{type:Number,default:1},pageSize:{type:Number,default:10}},emits:["update:pagination"],setup(e,{emit:t}){const n=kt(),s=e,a=t,r=x([]),i=x(1),l=x(0),h=p=>{if(p==null)return"¥0.00";const k=p<0,g=Math.abs(p);return g>=1e4?`${k?"-":""}¥${(g/1e4).toFixed(2)}万`:`${k?"-":""}¥${g.toFixed(2)}`},u=p=>{if(!p)return"";const k=p.substring(0,4),g=p.substring(4,6),b=p.substring(6,8);return`${k}/${g}/${b}`},d=async()=>{try{await n.fetchBacktestAccount(s.back_id,s.currentPage,s.pageSize),n.backtestAccount&&n.backtestAccount.data&&(r.value=n.backtestAccount.data.items||[],n.backtestAccount.data.pagination&&(l.value=n.backtestAccount.data.pagination.total,i.value=n.backtestAccount.data.pagination.total_pages,a("update:pagination",{currentPage:n.backtestAccount.data.pagination.page,pageSize:n.backtestAccount.data.pagination.page_size,totalPages:i.value,totalItems:l.value})))}catch(p){console.error("获取回测账户数据失败",p)}};return rt(()=>s.back_id,()=>{d()}),rt(()=>s.currentPage,()=>{d()}),rt(()=>s.pageSize,()=>{d()}),Ct(async()=>{await d()}),(p,k)=>(N(),B("div",Lr,[o("div",Or,[o("table",Fr,[k[0]||(k[0]=o("thead",null,[o("tr",null,[o("th",null,"日期"),o("th",null,"账户类别"),o("th",null,"可用资金"),o("th",null,"总权益"),o("th",null,"累计盈亏"),o("th",null,"市值"),o("th",null,"累计费用")])],-1)),o("tbody",null,[(N(!0),B(at,null,ht(r.value,(g,b)=>(N(),B("tr",{key:b},[o("td",null,I(u(g.gmt_create)),1),o("td",null,[o("div",null,I(g.type===1?"股票":"期货"),1)]),o("td",null,[o("div",null,I(h(g.available_funds)),1),o("div",jr,I(h(g.available_funds)),1)]),o("td",null,[o("div",null,I(h(g.start_capital)),1),o("div",Nr,I(h(g.yes_total_capital)),1)]),o("td",null,[o("div",{class:z(["profit",g.total_profit-g.start_capital<0?"negative":"positive"])},I(h(g.total_profit-g.start_capital)),3),o("div",{class:z(["sub-row profit",g.add_profit<0?"negative":"positive"])},I(h(g.add_profit)),3)]),o("td",null,[o("div",null,I(h(g.market_value)),1),o("div",Br,I(h(g.market_value)),1)]),o("td",null,[o("div",null,I(h(g.cost)),1),o("div",Ir,I(h(g.cost)),1)])]))),128))])])])]))}},Ur=bt(qr,[["__scopeId","data-v-1df0351b"]]),Mr={class:"strategy-container"},zr={key:1,class:"strategy-container-content"},Hr={class:"strategy-header"},Vr={class:"strategy-header-right"},Gr={key:0,class:"pagination"},Jr=["disabled"],Wr={class:"page-numbers"},Yr=["onClick","disabled"],Kr={key:1,class:"ellipsis"},Xr=["disabled"],Zr={key:1,class:"pagination"},Qr=["disabled"],to={class:"page-numbers"},eo=["onClick","disabled"],no={key:1,class:"ellipsis"},so=["disabled"],ao={class:"strategy-content"},ro={key:0,class:"tab-content"},oo={key:1,class:"tab-content"},io={key:2,class:"tab-content"},lo=Qt({__name:"index",emits:["apply"],setup(e,{expose:t,emit:n}){const s=Ge(),a=kt(),r=x("我的工作流"),i=x(!0),l=x(null),h=()=>{var D;(D=l.value)==null||D.openDialog()},u=n,d=x(!0),p=[{label:"收益概览",value:"strategy_overview"},{label:"交易详情",value:"strategy_details"},{label:"账户信息",value:"strategy_account"}];a.child_currentFootTab="strategy_overview";const k=x(1),g=x(40),b=x(1),S=x(0),_=x(!1),R=x(1),y=x(40),v=x(1),M=x(0),U=x(!1),G=D=>{k.value=D.currentPage,g.value=D.pageSize,b.value=D.totalPages,S.value=D.totalItems,_.value=!1},Q=D=>{R.value=D.currentPage,y.value=D.pageSize,v.value=D.totalPages,M.value=D.totalItems,U.value=!1},T=D=>{_.value||(_.value=!0,k.value=D)},f=D=>{U.value||(U.value=!0,R.value=D)},O=ft(()=>{const D=[];if(b.value<=5)for(let m=1;m<=b.value;m++)D.push(m);else{D.push(1);let m=Math.max(2,k.value-1),A=Math.min(b.value-1,k.value+1);m===2&&(A=Math.min(b.value-1,4)),A===b.value-1&&(m=Math.max(2,b.value-3)),m>2&&D.push("left-ellipsis");for(let w=m;w<=A;w++)D.push(w);A<b.value-1&&D.push("right-ellipsis"),D.push(b.value)}return D}),F=ft(()=>{const D=[];if(v.value<=5)for(let m=1;m<=v.value;m++)D.push(m);else{D.push(1);let m=Math.max(2,R.value-1),A=Math.min(v.value-1,R.value+1);m===2&&(A=Math.min(v.value-1,4)),A===v.value-1&&(m=Math.max(2,v.value-3)),m>2&&D.push("left-ellipsis");for(let w=m;w<=A;w++)D.push(w);A<v.value-1&&D.push("right-ellipsis"),D.push(v.value)}return D}),W=D=>{console.log("当前选中的tab:",D),D==="strategy_details"&&(k.value=1),D==="strategy_account"&&(R.value=1)},C=x(null),P=x({node_id:"",node_output:"",node_title:""}),$=x(null),H=async(D,E)=>{var L,j,K,it,Et;if(E!==!1)try{const nt=await a.fetchBacktestLastRunId(D.workflow_id,D.feature_tag,D.locator);if(nt.code===0)C.value=nt.data;else if(nt.code===-1001){s.warning("工作流正在运行，请等待完成后再点击应用！"),(L=$.value)==null||L.resetLoadingState();return}else if(nt.code===-1002){s.error("工作流运行错误，请重新去工作流重新运行！"),(j=$.value)==null||j.resetLoadingState();return}else if(nt.code===-1003){s.warning("工作流没有运行过，请去工作流运行！"),(K=$.value)==null||K.resetLoadingState();return}console.log("applyData.value",C.value),nt.data&&nt.data.length>0&&(P.value=nt.data[0])}catch(nt){console.log("请求接口出错:",nt),s.error("请求接口出错，请检查网络！"),(it=$.value)==null||it.resetLoadingState();return}else P.value.node_output=D.workflow_id;(Et=$.value)==null||Et.resetLoadingState(),E===!1&&(i.value=!1),console.log("应用项目：",D),d.value=!1,r.value=D.title;const m=D.timeRange||a.timeRange,A=D.startDate||a.startDate,w=D.endDate||a.endDate;u("apply",{type:"strategy",positionHeight:40,selectedApplyData:P.value,timeRange:m,startDate:A,endDate:w})},Y=()=>{d.value=!0,a.child_currentFootTab="strategy_overview",u("apply",{type:"strategy",positionHeight:0})};return Ct(async()=>{await a.fetchBacktestList(),console.log("策略列表返回的数据:",a.backtestList)}),t({handleApply:H}),(D,E)=>{var m,A,w;return N(),B(at,null,[o("div",Mr,[d.value?(N(),xn(Ua,{key:0,ref_key:"tableaRef",ref:$,onApply:H,tableData:V(a).backtestList||[]},null,8,["tableData"])):(N(),B("div",zr,[o("div",Hr,[ut(ya,{onBack:Y,backs:i.value,title:r.value},null,8,["backs","title"]),ut(vn,{"tab-list":p,tab:V(a).child_currentFootTab,"onUpdate:tab":[E[0]||(E[0]=L=>V(a).child_currentFootTab=L),W]},null,8,["tab"]),o("div",Vr,[o("div",{class:"showlog-btn",onClick:h}," 查看日志 "),V(a).child_currentFootTab==="strategy_details"?(N(),B("div",Gr,[o("button",{disabled:k.value===1||_.value,onClick:E[1]||(E[1]=L=>T(k.value-1)),class:"page-btn"},E[5]||(E[5]=[o("svg",{class:"arrow-icon",viewBox:"0 0 24 24",fill:"currentColor"},[o("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})],-1)]),8,Jr),o("div",Wr,[(N(!0),B(at,null,ht(O.value,(L,j)=>(N(),B(at,{key:j},[typeof L=="number"?(N(),B("button",{key:0,class:z(["page-number",k.value===L?"active":""]),onClick:K=>T(L),disabled:_.value},I(L),11,Yr)):(N(),B("span",Kr,"..."))],64))),128))]),o("button",{disabled:k.value===b.value||_.value,onClick:E[2]||(E[2]=L=>T(k.value+1)),class:"page-btn"},E[6]||(E[6]=[o("svg",{class:"arrow-icon",viewBox:"0 0 24 24",fill:"currentColor"},[o("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})],-1)]),8,Xr)])):dt("",!0),V(a).child_currentFootTab==="strategy_account"?(N(),B("div",Zr,[o("button",{disabled:R.value===1||U.value,onClick:E[3]||(E[3]=L=>f(R.value-1)),class:"page-btn"},E[7]||(E[7]=[o("svg",{class:"arrow-icon",viewBox:"0 0 24 24",fill:"currentColor"},[o("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})],-1)]),8,Qr),o("div",to,[(N(!0),B(at,null,ht(F.value,(L,j)=>(N(),B(at,{key:j},[typeof L=="number"?(N(),B("button",{key:0,class:z(["page-number",R.value===L?"active":""]),onClick:K=>f(L),disabled:U.value},I(L),11,eo)):(N(),B("span",no,"..."))],64))),128))]),o("button",{disabled:R.value===v.value||U.value,onClick:E[4]||(E[4]=L=>f(R.value+1)),class:"page-btn"},E[8]||(E[8]=[o("svg",{class:"arrow-icon",viewBox:"0 0 24 24",fill:"currentColor"},[o("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})],-1)]),8,so)])):dt("",!0)])]),o("div",ao,[V(a).child_currentFootTab==="strategy_overview"?(N(),B("div",ro,[ut(Rr,{back_id:(m=P.value)==null?void 0:m.node_output},null,8,["back_id"])])):dt("",!0),V(a).child_currentFootTab==="strategy_details"?(N(),B("div",oo,[ut(Pr,{back_id:(A=P.value)==null?void 0:A.node_output,"current-page":k.value,"page-size":g.value,"onUpdate:pagination":G},null,8,["back_id","current-page","page-size"])])):dt("",!0),V(a).child_currentFootTab==="strategy_account"?(N(),B("div",io,[ut(Ur,{back_id:(w=P.value)==null?void 0:w.node_output,"current-page":R.value,"page-size":y.value,"onUpdate:pagination":Q},null,8,["back_id","current-page","page-size"])])):dt("",!0)])]))]),ut(rr,{ref_key:"logsDialog",ref:l},null,512)],64)}}}),Jo=bt(lo,[["__scopeId","data-v-fdea7a0f"]]);export{fo as G,rr as L,ya as T,Co as a,So as b,To as c,ho as d,bo as e,go as f,yo as g,mo as h,wo as i,vo as j,_o as k,ko as l,Eo as m,po as n,J as o,Ve as p,Vo as q,Go as r,Jo as s,vn as t,kt as u};
