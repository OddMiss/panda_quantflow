import{_ as ft,c as O,a as rt,o as L,b as r,d as Ft,r as $,H as it,F as ot,k as bt,i as H,t as I,V as En,a1 as De,O as Sn,B as We,e as Cn,v as pt,y as ht,z as Tn,m as Pe,L as Rn,N as vt,j as z,h as at,w as $n,I as xn,f as Tt,C as Ye,a2 as xt,A as zt,x as An,J as Le,g as Dn,$ as Ht,l as Pn}from"./main-Da51aAcg.js";import{r as Ln}from"./index-B6eQQIY2.js";const On={name:"Loading",props:{visible:{type:Boolean,default:!1}}},Fn={key:0,class:"loading-mask"};function jn(e,t,n,s,a,o){return n.visible?(L(),O("div",Fn,t[0]||(t[0]=[r("div",{class:"simple-spinner"},null,-1),r("span",null,"loading...",-1)]))):rt("",!0)}const ee=ft(On,[["render",jn],["__scopeId","data-v-62b7c2f0"]]),Nn="http://localhost:8001",Bn=1e4;function In(e){var t;throw(e==null?void 0:e.name)==="AbortError"?new Error("请求超时,超过10秒"):(t=e==null?void 0:e.message)!=null&&t.includes("Failed to fetch")?new Error("网络连接失败，请检查网络是否正常！"):(console.log("请求错误:",e),e)}async function Z(e,t){const n={},s=localStorage.getItem("token"),a=localStorage.getItem("userid");s&&a&&(n.Authorization=`${s}`,n.userId=`${a}`);const o=new AbortController,i=setTimeout(()=>o.abort(),Bn);try{const l=await fetch(Nn+"/"+e,{headers:n,...t,signal:o.signal});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return Promise.resolve({response:l,httpController:o})}catch(l){In(l)}finally{clearTimeout(i)}}async function $r(e){try{const t=await Z(`api/v1/query_one_group_data?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function xr(e){try{const t=await Z(`api/v1/query_factor_analysis_data?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Ar(e){try{const t=await Z(`api/v1/query_ic_decay_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Dr(e){try{const t=await Z(`api/v1/query_ic_density_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Pr(e){try{const t=await Z(`api/v1/query_ic_sequence_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Lr(e){try{const t=await Z(`api/v1/query_ic_self_correlation_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Or(e){try{const t=await Z(`api/v1/query_rank_ic_decay_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Fr(e){try{const t=await Z(`api/v1/query_rank_ic_density_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function jr(e){try{const t=await Z(`api/v1/query_rank_ic_sequence_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Nr(e){try{const t=await Z(`api/v1/query_rank_ic_self_correlation_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Br(e){try{const t=await Z(`api/v1/query_return_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Ir(e){try{const t=await Z(`api/v1/query_factor_excess_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function qr(e){try{const t=await Z(`api/v1/query_group_return_analysis?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Ur(e){try{const t=await Z(`api/v1/query_last_date_top_factor?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}async function Mr(e){try{const t=await Z(`api/v1/query_return_chart?task_id=${e}`);if(!(t!=null&&t.response))throw new Error("请求失败：未收到响应");return{json:await t.response.json(),httpController:t.httpController}}catch(t){throw t}}function Ke(e,t){return function(){return e.apply(t,arguments)}}const{toString:qn}=Object.prototype,{getPrototypeOf:ne}=Object,{iterator:jt,toStringTag:Xe}=Symbol,Nt=(e=>t=>{const n=qn.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),lt=e=>(e=e.toLowerCase(),t=>Nt(t)===e),Bt=e=>t=>typeof t===e,{isArray:wt}=Array,Ct=Bt("undefined");function Un(e){return e!==null&&!Ct(e)&&e.constructor!==null&&!Ct(e.constructor)&&tt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Ze=lt("ArrayBuffer");function Mn(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Ze(e.buffer),t}const zn=Bt("string"),tt=Bt("function"),Qe=Bt("number"),It=e=>e!==null&&typeof e=="object",Hn=e=>e===!0||e===!1,At=e=>{if(Nt(e)!=="object")return!1;const t=ne(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Xe in e)&&!(jt in e)},Vn=lt("Date"),Gn=lt("File"),Jn=lt("Blob"),Wn=lt("FileList"),Yn=e=>It(e)&&tt(e.pipe),Kn=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||tt(e.append)&&((t=Nt(e))==="formdata"||t==="object"&&tt(e.toString)&&e.toString()==="[object FormData]"))},Xn=lt("URLSearchParams"),[Zn,Qn,ts,es]=["ReadableStream","Request","Response","Headers"].map(lt),ns=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Rt(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,a;if(typeof e!="object"&&(e=[e]),wt(e))for(s=0,a=e.length;s<a;s++)t.call(null,e[s],s,e);else{const o=n?Object.getOwnPropertyNames(e):Object.keys(e),i=o.length;let l;for(s=0;s<i;s++)l=o[s],t.call(null,e[l],l,e)}}function tn(e,t){t=t.toLowerCase();const n=Object.keys(e);let s=n.length,a;for(;s-- >0;)if(a=n[s],t===a.toLowerCase())return a;return null}const gt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,en=e=>!Ct(e)&&e!==gt;function Yt(){const{caseless:e}=en(this)&&this||{},t={},n=(s,a)=>{const o=e&&tn(t,a)||a;At(t[o])&&At(s)?t[o]=Yt(t[o],s):At(s)?t[o]=Yt({},s):wt(s)?t[o]=s.slice():t[o]=s};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Rt(arguments[s],n);return t}const ss=(e,t,n,{allOwnKeys:s}={})=>(Rt(t,(a,o)=>{n&&tt(a)?e[o]=Ke(a,n):e[o]=a},{allOwnKeys:s}),e),as=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),os=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},rs=(e,t,n,s)=>{let a,o,i;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)i=a[o],(!s||s(i,e,t))&&!l[i]&&(t[i]=e[i],l[i]=!0);e=n!==!1&&ne(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},is=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},ls=e=>{if(!e)return null;if(wt(e))return e;let t=e.length;if(!Qe(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},cs=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ne(Uint8Array)),us=(e,t)=>{const s=(e&&e[jt]).call(e);let a;for(;(a=s.next())&&!a.done;){const o=a.value;t.call(e,o[0],o[1])}},ds=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},fs=lt("HTMLFormElement"),ps=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,a){return s.toUpperCase()+a}),Oe=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),hs=lt("RegExp"),nn=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};Rt(n,(a,o)=>{let i;(i=t(a,o,e))!==!1&&(s[o]=i||a)}),Object.defineProperties(e,s)},bs=e=>{nn(e,(t,n)=>{if(tt(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(tt(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},gs=(e,t)=>{const n={},s=a=>{a.forEach(o=>{n[o]=!0})};return wt(e)?s(e):s(String(e).split(t)),n},ys=()=>{},ms=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function vs(e){return!!(e&&tt(e.append)&&e[Xe]==="FormData"&&e[jt])}const ws=e=>{const t=new Array(10),n=(s,a)=>{if(It(s)){if(t.indexOf(s)>=0)return;if(!("toJSON"in s)){t[a]=s;const o=wt(s)?[]:{};return Rt(s,(i,l)=>{const h=n(i,a+1);!Ct(h)&&(o[l]=h)}),t[a]=void 0,o}}return s};return n(e,0)},_s=lt("AsyncFunction"),ks=e=>e&&(It(e)||tt(e))&&tt(e.then)&&tt(e.catch),sn=((e,t)=>e?setImmediate:t?((n,s)=>(gt.addEventListener("message",({source:a,data:o})=>{a===gt&&o===n&&s.length&&s.shift()()},!1),a=>{s.push(a),gt.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",tt(gt.postMessage)),Es=typeof queueMicrotask<"u"?queueMicrotask.bind(gt):typeof process<"u"&&process.nextTick||sn,Ss=e=>e!=null&&tt(e[jt]),c={isArray:wt,isArrayBuffer:Ze,isBuffer:Un,isFormData:Kn,isArrayBufferView:Mn,isString:zn,isNumber:Qe,isBoolean:Hn,isObject:It,isPlainObject:At,isReadableStream:Zn,isRequest:Qn,isResponse:ts,isHeaders:es,isUndefined:Ct,isDate:Vn,isFile:Gn,isBlob:Jn,isRegExp:hs,isFunction:tt,isStream:Yn,isURLSearchParams:Xn,isTypedArray:cs,isFileList:Wn,forEach:Rt,merge:Yt,extend:ss,trim:ns,stripBOM:as,inherits:os,toFlatObject:rs,kindOf:Nt,kindOfTest:lt,endsWith:is,toArray:ls,forEachEntry:us,matchAll:ds,isHTMLForm:fs,hasOwnProperty:Oe,hasOwnProp:Oe,reduceDescriptors:nn,freezeMethods:bs,toObjectSet:gs,toCamelCase:ps,noop:ys,toFiniteNumber:ms,findKey:tn,global:gt,isContextDefined:en,isSpecCompliantForm:vs,toJSONObject:ws,isAsyncFn:_s,isThenable:ks,setImmediate:sn,asap:Es,isIterable:Ss};function q(e,t,n,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}c.inherits(q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:c.toJSONObject(this.config),code:this.code,status:this.status}}});const an=q.prototype,on={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{on[e]={value:e}});Object.defineProperties(q,on);Object.defineProperty(an,"isAxiosError",{value:!0});q.from=(e,t,n,s,a,o)=>{const i=Object.create(an);return c.toFlatObject(e,i,function(h){return h!==Error.prototype},l=>l!=="isAxiosError"),q.call(i,e.message,t,n,s,a),i.cause=e,i.name=e.name,o&&Object.assign(i,o),i};const Cs=null;function Kt(e){return c.isPlainObject(e)||c.isArray(e)}function rn(e){return c.endsWith(e,"[]")?e.slice(0,-2):e}function Fe(e,t,n){return e?e.concat(t).map(function(a,o){return a=rn(a),!n&&o?"["+a+"]":a}).join(n?".":""):t}function Ts(e){return c.isArray(e)&&!e.some(Kt)}const Rs=c.toFlatObject(c,{},null,function(t){return/^is[A-Z]/.test(t)});function qt(e,t,n){if(!c.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=c.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,k){return!c.isUndefined(k[S])});const s=n.metaTokens,a=n.visitor||d,o=n.dots,i=n.indexes,h=(n.Blob||typeof Blob<"u"&&Blob)&&c.isSpecCompliantForm(t);if(!c.isFunction(a))throw new TypeError("visitor must be a function");function u(b){if(b===null)return"";if(c.isDate(b))return b.toISOString();if(!h&&c.isBlob(b))throw new q("Blob is not supported. Use a Buffer instead.");return c.isArrayBuffer(b)||c.isTypedArray(b)?h&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function d(b,S,k){let R=b;if(b&&!k&&typeof b=="object"){if(c.endsWith(S,"{}"))S=s?S:S.slice(0,-2),b=JSON.stringify(b);else if(c.isArray(b)&&Ts(b)||(c.isFileList(b)||c.endsWith(S,"[]"))&&(R=c.toArray(b)))return S=rn(S),R.forEach(function(w,M){!(c.isUndefined(w)||w===null)&&t.append(i===!0?Fe([S],M,o):i===null?S:S+"[]",u(w))}),!1}return Kt(b)?!0:(t.append(Fe(k,S,o),u(b)),!1)}const p=[],_=Object.assign(Rs,{defaultVisitor:d,convertValue:u,isVisitable:Kt});function g(b,S){if(!c.isUndefined(b)){if(p.indexOf(b)!==-1)throw Error("Circular reference detected in "+S.join("."));p.push(b),c.forEach(b,function(R,y){(!(c.isUndefined(R)||R===null)&&a.call(t,R,c.isString(y)?y.trim():y,S,_))===!0&&g(R,S?S.concat(y):[y])}),p.pop()}}if(!c.isObject(e))throw new TypeError("data must be an object");return g(e),t}function je(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function se(e,t){this._pairs=[],e&&qt(e,this,t)}const ln=se.prototype;ln.append=function(t,n){this._pairs.push([t,n])};ln.toString=function(t){const n=t?function(s){return t.call(this,s,je)}:je;return this._pairs.map(function(a){return n(a[0])+"="+n(a[1])},"").join("&")};function $s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function cn(e,t,n){if(!t)return e;const s=n&&n.encode||$s;c.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let o;if(a?o=a(t,n):o=c.isURLSearchParams(t)?t.toString():new se(t,n).toString(s),o){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class Ne{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){c.forEach(this.handlers,function(s){s!==null&&t(s)})}}const un={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xs=typeof URLSearchParams<"u"?URLSearchParams:se,As=typeof FormData<"u"?FormData:null,Ds=typeof Blob<"u"?Blob:null,Ps={isBrowser:!0,classes:{URLSearchParams:xs,FormData:As,Blob:Ds},protocols:["http","https","file","blob","url","data"]},ae=typeof window<"u"&&typeof document<"u",Xt=typeof navigator=="object"&&navigator||void 0,Ls=ae&&(!Xt||["ReactNative","NativeScript","NS"].indexOf(Xt.product)<0),Os=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Fs=ae&&window.location.href||"http://localhost",js=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ae,hasStandardBrowserEnv:Ls,hasStandardBrowserWebWorkerEnv:Os,navigator:Xt,origin:Fs},Symbol.toStringTag,{value:"Module"})),X={...js,...Ps};function Ns(e,t){return qt(e,new X.classes.URLSearchParams,Object.assign({visitor:function(n,s,a,o){return X.isNode&&c.isBuffer(n)?(this.append(s,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},t))}function Bs(e){return c.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Is(e){const t={},n=Object.keys(e);let s;const a=n.length;let o;for(s=0;s<a;s++)o=n[s],t[o]=e[o];return t}function dn(e){function t(n,s,a,o){let i=n[o++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),h=o>=n.length;return i=!i&&c.isArray(a)?a.length:i,h?(c.hasOwnProp(a,i)?a[i]=[a[i],s]:a[i]=s,!l):((!a[i]||!c.isObject(a[i]))&&(a[i]=[]),t(n,s,a[i],o)&&c.isArray(a[i])&&(a[i]=Is(a[i])),!l)}if(c.isFormData(e)&&c.isFunction(e.entries)){const n={};return c.forEachEntry(e,(s,a)=>{t(Bs(s),a,n,0)}),n}return null}function qs(e,t,n){if(c.isString(e))try{return(t||JSON.parse)(e),c.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const $t={transitional:un,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",a=s.indexOf("application/json")>-1,o=c.isObject(t);if(o&&c.isHTMLForm(t)&&(t=new FormData(t)),c.isFormData(t))return a?JSON.stringify(dn(t)):t;if(c.isArrayBuffer(t)||c.isBuffer(t)||c.isStream(t)||c.isFile(t)||c.isBlob(t)||c.isReadableStream(t))return t;if(c.isArrayBufferView(t))return t.buffer;if(c.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(o){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Ns(t,this.formSerializer).toString();if((l=c.isFileList(t))||s.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return qt(l?{"files[]":t}:t,h&&new h,this.formSerializer)}}return o||a?(n.setContentType("application/json",!1),qs(t)):t}],transformResponse:[function(t){const n=this.transitional||$t.transitional,s=n&&n.forcedJSONParsing,a=this.responseType==="json";if(c.isResponse(t)||c.isReadableStream(t))return t;if(t&&c.isString(t)&&(s&&!this.responseType||a)){const i=!(n&&n.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(i)throw l.name==="SyntaxError"?q.from(l,q.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:X.classes.FormData,Blob:X.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};c.forEach(["delete","get","head","post","put","patch"],e=>{$t.headers[e]={}});const Us=c.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ms=e=>{const t={};let n,s,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),n=i.substring(0,a).trim().toLowerCase(),s=i.substring(a+1).trim(),!(!n||t[n]&&Us[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},Be=Symbol("internals");function St(e){return e&&String(e).trim().toLowerCase()}function Dt(e){return e===!1||e==null?e:c.isArray(e)?e.map(Dt):String(e)}function zs(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const Hs=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Vt(e,t,n,s,a){if(c.isFunction(s))return s.call(this,t,n);if(a&&(t=n),!!c.isString(t)){if(c.isString(s))return t.indexOf(s)!==-1;if(c.isRegExp(s))return s.test(t)}}function Vs(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function Gs(e,t){const n=c.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(a,o,i){return this[s].call(this,t,a,o,i)},configurable:!0})})}let et=class{constructor(t){t&&this.set(t)}set(t,n,s){const a=this;function o(l,h,u){const d=St(h);if(!d)throw new Error("header name must be a non-empty string");const p=c.findKey(a,d);(!p||a[p]===void 0||u===!0||u===void 0&&a[p]!==!1)&&(a[p||h]=Dt(l))}const i=(l,h)=>c.forEach(l,(u,d)=>o(u,d,h));if(c.isPlainObject(t)||t instanceof this.constructor)i(t,n);else if(c.isString(t)&&(t=t.trim())&&!Hs(t))i(Ms(t),n);else if(c.isObject(t)&&c.isIterable(t)){let l={},h,u;for(const d of t){if(!c.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(h=l[u])?c.isArray(h)?[...h,d[1]]:[h,d[1]]:d[1]}i(l,n)}else t!=null&&o(n,t,s);return this}get(t,n){if(t=St(t),t){const s=c.findKey(this,t);if(s){const a=this[s];if(!n)return a;if(n===!0)return zs(a);if(c.isFunction(n))return n.call(this,a,s);if(c.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=St(t),t){const s=c.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||Vt(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let a=!1;function o(i){if(i=St(i),i){const l=c.findKey(s,i);l&&(!n||Vt(s,s[l],l,n))&&(delete s[l],a=!0)}}return c.isArray(t)?t.forEach(o):o(t),a}clear(t){const n=Object.keys(this);let s=n.length,a=!1;for(;s--;){const o=n[s];(!t||Vt(this,this[o],o,t,!0))&&(delete this[o],a=!0)}return a}normalize(t){const n=this,s={};return c.forEach(this,(a,o)=>{const i=c.findKey(s,o);if(i){n[i]=Dt(a),delete n[o];return}const l=t?Vs(o):String(o).trim();l!==o&&delete n[o],n[l]=Dt(a),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return c.forEach(this,(s,a)=>{s!=null&&s!==!1&&(n[a]=t&&c.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(a=>s.set(a)),s}static accessor(t){const s=(this[Be]=this[Be]={accessors:{}}).accessors,a=this.prototype;function o(i){const l=St(i);s[l]||(Gs(a,i),s[l]=!0)}return c.isArray(t)?t.forEach(o):o(t),this}};et.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);c.reduceDescriptors(et.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});c.freezeMethods(et);function Gt(e,t){const n=this||$t,s=t||n,a=et.from(s.headers);let o=s.data;return c.forEach(e,function(l){o=l.call(n,o,a.normalize(),t?t.status:void 0)}),a.normalize(),o}function fn(e){return!!(e&&e.__CANCEL__)}function _t(e,t,n){q.call(this,e??"canceled",q.ERR_CANCELED,t,n),this.name="CanceledError"}c.inherits(_t,q,{__CANCEL__:!0});function pn(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new q("Request failed with status code "+n.status,[q.ERR_BAD_REQUEST,q.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Js(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Ws(e,t){e=e||10;const n=new Array(e),s=new Array(e);let a=0,o=0,i;return t=t!==void 0?t:1e3,function(h){const u=Date.now(),d=s[o];i||(i=u),n[a]=h,s[a]=u;let p=o,_=0;for(;p!==a;)_+=n[p++],p=p%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),u-i<t)return;const g=d&&u-d;return g?Math.round(_*1e3/g):void 0}}function Ys(e,t){let n=0,s=1e3/t,a,o;const i=(u,d=Date.now())=>{n=d,a=null,o&&(clearTimeout(o),o=null),e.apply(null,u)};return[(...u)=>{const d=Date.now(),p=d-n;p>=s?i(u,d):(a=u,o||(o=setTimeout(()=>{o=null,i(a)},s-p)))},()=>a&&i(a)]}const Lt=(e,t,n=3)=>{let s=0;const a=Ws(50,250);return Ys(o=>{const i=o.loaded,l=o.lengthComputable?o.total:void 0,h=i-s,u=a(h),d=i<=l;s=i;const p={loaded:i,total:l,progress:l?i/l:void 0,bytes:h,rate:u||void 0,estimated:u&&l&&d?(l-i)/u:void 0,event:o,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(p)},n)},Ie=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},qe=e=>(...t)=>c.asap(()=>e(...t)),Ks=X.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,X.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(X.origin),X.navigator&&/(msie|trident)/i.test(X.navigator.userAgent)):()=>!0,Xs=X.hasStandardBrowserEnv?{write(e,t,n,s,a,o){const i=[e+"="+encodeURIComponent(t)];c.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),c.isString(s)&&i.push("path="+s),c.isString(a)&&i.push("domain="+a),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Zs(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Qs(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function hn(e,t,n){let s=!Zs(t);return e&&(s||n==!1)?Qs(e,t):t}const Ue=e=>e instanceof et?{...e}:e;function mt(e,t){t=t||{};const n={};function s(u,d,p,_){return c.isPlainObject(u)&&c.isPlainObject(d)?c.merge.call({caseless:_},u,d):c.isPlainObject(d)?c.merge({},d):c.isArray(d)?d.slice():d}function a(u,d,p,_){if(c.isUndefined(d)){if(!c.isUndefined(u))return s(void 0,u,p,_)}else return s(u,d,p,_)}function o(u,d){if(!c.isUndefined(d))return s(void 0,d)}function i(u,d){if(c.isUndefined(d)){if(!c.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function l(u,d,p){if(p in t)return s(u,d);if(p in e)return s(void 0,u)}const h={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(u,d,p)=>a(Ue(u),Ue(d),p,!0)};return c.forEach(Object.keys(Object.assign({},e,t)),function(d){const p=h[d]||a,_=p(e[d],t[d],d);c.isUndefined(_)&&p!==l||(n[d]=_)}),n}const bn=e=>{const t=mt({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:o,headers:i,auth:l}=t;t.headers=i=et.from(i),t.url=cn(hn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let h;if(c.isFormData(n)){if(X.hasStandardBrowserEnv||X.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((h=i.getContentType())!==!1){const[u,...d]=h?h.split(";").map(p=>p.trim()).filter(Boolean):[];i.setContentType([u||"multipart/form-data",...d].join("; "))}}if(X.hasStandardBrowserEnv&&(s&&c.isFunction(s)&&(s=s(t)),s||s!==!1&&Ks(t.url))){const u=a&&o&&Xs.read(o);u&&i.set(a,u)}return t},ta=typeof XMLHttpRequest<"u",ea=ta&&function(e){return new Promise(function(n,s){const a=bn(e);let o=a.data;const i=et.from(a.headers).normalize();let{responseType:l,onUploadProgress:h,onDownloadProgress:u}=a,d,p,_,g,b;function S(){g&&g(),b&&b(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let k=new XMLHttpRequest;k.open(a.method.toUpperCase(),a.url,!0),k.timeout=a.timeout;function R(){if(!k)return;const w=et.from("getAllResponseHeaders"in k&&k.getAllResponseHeaders()),U={data:!l||l==="text"||l==="json"?k.responseText:k.response,status:k.status,statusText:k.statusText,headers:w,config:e,request:k};pn(function(Q){n(Q),S()},function(Q){s(Q),S()},U),k=null}"onloadend"in k?k.onloadend=R:k.onreadystatechange=function(){!k||k.readyState!==4||k.status===0&&!(k.responseURL&&k.responseURL.indexOf("file:")===0)||setTimeout(R)},k.onabort=function(){k&&(s(new q("Request aborted",q.ECONNABORTED,e,k)),k=null)},k.onerror=function(){s(new q("Network Error",q.ERR_NETWORK,e,k)),k=null},k.ontimeout=function(){let M=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const U=a.transitional||un;a.timeoutErrorMessage&&(M=a.timeoutErrorMessage),s(new q(M,U.clarifyTimeoutError?q.ETIMEDOUT:q.ECONNABORTED,e,k)),k=null},o===void 0&&i.setContentType(null),"setRequestHeader"in k&&c.forEach(i.toJSON(),function(M,U){k.setRequestHeader(U,M)}),c.isUndefined(a.withCredentials)||(k.withCredentials=!!a.withCredentials),l&&l!=="json"&&(k.responseType=a.responseType),u&&([_,b]=Lt(u,!0),k.addEventListener("progress",_)),h&&k.upload&&([p,g]=Lt(h),k.upload.addEventListener("progress",p),k.upload.addEventListener("loadend",g)),(a.cancelToken||a.signal)&&(d=w=>{k&&(s(!w||w.type?new _t(null,e,k):w),k.abort(),k=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const y=Js(a.url);if(y&&X.protocols.indexOf(y)===-1){s(new q("Unsupported protocol "+y+":",q.ERR_BAD_REQUEST,e));return}k.send(o||null)})},na=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,a;const o=function(u){if(!a){a=!0,l();const d=u instanceof Error?u:this.reason;s.abort(d instanceof q?d:new _t(d instanceof Error?d.message:d))}};let i=t&&setTimeout(()=>{i=null,o(new q(`timeout ${t} of ms exceeded`,q.ETIMEDOUT))},t);const l=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),e=null)};e.forEach(u=>u.addEventListener("abort",o));const{signal:h}=s;return h.unsubscribe=()=>c.asap(l),h}},sa=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,a;for(;s<n;)a=s+t,yield e.slice(s,a),s=a},aa=async function*(e,t){for await(const n of oa(e))yield*sa(n,t)},oa=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},Me=(e,t,n,s)=>{const a=aa(e,t);let o=0,i,l=h=>{i||(i=!0,s&&s(h))};return new ReadableStream({async pull(h){try{const{done:u,value:d}=await a.next();if(u){l(),h.close();return}let p=d.byteLength;if(n){let _=o+=p;n(_)}h.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(h){return l(h),a.return()}},{highWaterMark:2})},Ut=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",gn=Ut&&typeof ReadableStream=="function",ra=Ut&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),yn=(e,...t)=>{try{return!!e(...t)}catch{return!1}},ia=gn&&yn(()=>{let e=!1;const t=new Request(X.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),ze=64*1024,Zt=gn&&yn(()=>c.isReadableStream(new Response("").body)),Ot={stream:Zt&&(e=>e.body)};Ut&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Ot[t]&&(Ot[t]=c.isFunction(e[t])?n=>n[t]():(n,s)=>{throw new q(`Response type '${t}' is not supported`,q.ERR_NOT_SUPPORT,s)})})})(new Response);const la=async e=>{if(e==null)return 0;if(c.isBlob(e))return e.size;if(c.isSpecCompliantForm(e))return(await new Request(X.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(c.isArrayBufferView(e)||c.isArrayBuffer(e))return e.byteLength;if(c.isURLSearchParams(e)&&(e=e+""),c.isString(e))return(await ra(e)).byteLength},ca=async(e,t)=>{const n=c.toFiniteNumber(e.getContentLength());return n??la(t)},ua=Ut&&(async e=>{let{url:t,method:n,data:s,signal:a,cancelToken:o,timeout:i,onDownloadProgress:l,onUploadProgress:h,responseType:u,headers:d,withCredentials:p="same-origin",fetchOptions:_}=bn(e);u=u?(u+"").toLowerCase():"text";let g=na([a,o&&o.toAbortSignal()],i),b;const S=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let k;try{if(h&&ia&&n!=="get"&&n!=="head"&&(k=await ca(d,s))!==0){let U=new Request(t,{method:"POST",body:s,duplex:"half"}),G;if(c.isFormData(s)&&(G=U.headers.get("content-type"))&&d.setContentType(G),U.body){const[Q,C]=Ie(k,Lt(qe(h)));s=Me(U.body,ze,Q,C)}}c.isString(p)||(p=p?"include":"omit");const R="credentials"in Request.prototype;b=new Request(t,{..._,signal:g,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:s,duplex:"half",credentials:R?p:void 0});let y=await fetch(b);const w=Zt&&(u==="stream"||u==="response");if(Zt&&(l||w&&S)){const U={};["status","statusText","headers"].forEach(f=>{U[f]=y[f]});const G=c.toFiniteNumber(y.headers.get("content-length")),[Q,C]=l&&Ie(G,Lt(qe(l),!0))||[];y=new Response(Me(y.body,ze,Q,()=>{C&&C(),S&&S()}),U)}u=u||"text";let M=await Ot[c.findKey(Ot,u)||"text"](y,e);return!w&&S&&S(),await new Promise((U,G)=>{pn(U,G,{data:M,headers:et.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:b})})}catch(R){throw S&&S(),R&&R.name==="TypeError"&&/Load failed|fetch/i.test(R.message)?Object.assign(new q("Network Error",q.ERR_NETWORK,e,b),{cause:R.cause||R}):q.from(R,R&&R.code,e,b)}}),Qt={http:Cs,xhr:ea,fetch:ua};c.forEach(Qt,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const He=e=>`- ${e}`,da=e=>c.isFunction(e)||e===null||e===!1,mn={getAdapter:e=>{e=c.isArray(e)?e:[e];const{length:t}=e;let n,s;const a={};for(let o=0;o<t;o++){n=e[o];let i;if(s=n,!da(n)&&(s=Qt[(i=String(n)).toLowerCase()],s===void 0))throw new q(`Unknown adapter '${i}'`);if(s)break;a[i||"#"+o]=s}if(!s){const o=Object.entries(a).map(([l,h])=>`adapter ${l} `+(h===!1?"is not supported by the environment":"is not available in the build"));let i=t?o.length>1?`since :
`+o.map(He).join(`
`):" "+He(o[0]):"as no adapter specified";throw new q("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return s},adapters:Qt};function Jt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new _t(null,e)}function Ve(e){return Jt(e),e.headers=et.from(e.headers),e.data=Gt.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),mn.getAdapter(e.adapter||$t.adapter)(e).then(function(s){return Jt(e),s.data=Gt.call(e,e.transformResponse,s),s.headers=et.from(s.headers),s},function(s){return fn(s)||(Jt(e),s&&s.response&&(s.response.data=Gt.call(e,e.transformResponse,s.response),s.response.headers=et.from(s.response.headers))),Promise.reject(s)})}const vn="1.9.0",Mt={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Mt[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const Ge={};Mt.transitional=function(t,n,s){function a(o,i){return"[Axios v"+vn+"] Transitional option '"+o+"'"+i+(s?". "+s:"")}return(o,i,l)=>{if(t===!1)throw new q(a(i," has been removed"+(n?" in "+n:"")),q.ERR_DEPRECATED);return n&&!Ge[i]&&(Ge[i]=!0,console.warn(a(i," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(o,i,l):!0}};Mt.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function fa(e,t,n){if(typeof e!="object")throw new q("options must be an object",q.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let a=s.length;for(;a-- >0;){const o=s[a],i=t[o];if(i){const l=e[o],h=l===void 0||i(l,o,e);if(h!==!0)throw new q("option "+o+" must be "+h,q.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new q("Unknown option "+o,q.ERR_BAD_OPTION)}}const Pt={assertOptions:fa,validators:Mt},ut=Pt.validators;let yt=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Ne,response:new Ne}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?o&&!String(s.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+o):s.stack=o}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=mt(this.defaults,n);const{transitional:s,paramsSerializer:a,headers:o}=n;s!==void 0&&Pt.assertOptions(s,{silentJSONParsing:ut.transitional(ut.boolean),forcedJSONParsing:ut.transitional(ut.boolean),clarifyTimeoutError:ut.transitional(ut.boolean)},!1),a!=null&&(c.isFunction(a)?n.paramsSerializer={serialize:a}:Pt.assertOptions(a,{encode:ut.function,serialize:ut.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Pt.assertOptions(n,{baseUrl:ut.spelling("baseURL"),withXsrfToken:ut.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=o&&c.merge(o.common,o[n.method]);o&&c.forEach(["delete","get","head","post","put","patch","common"],b=>{delete o[b]}),n.headers=et.concat(i,o);const l=[];let h=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(n)===!1||(h=h&&S.synchronous,l.unshift(S.fulfilled,S.rejected))});const u=[];this.interceptors.response.forEach(function(S){u.push(S.fulfilled,S.rejected)});let d,p=0,_;if(!h){const b=[Ve.bind(this),void 0];for(b.unshift.apply(b,l),b.push.apply(b,u),_=b.length,d=Promise.resolve(n);p<_;)d=d.then(b[p++],b[p++]);return d}_=l.length;let g=n;for(p=0;p<_;){const b=l[p++],S=l[p++];try{g=b(g)}catch(k){S.call(this,k);break}}try{d=Ve.call(this,g)}catch(b){return Promise.reject(b)}for(p=0,_=u.length;p<_;)d=d.then(u[p++],u[p++]);return d}getUri(t){t=mt(this.defaults,t);const n=hn(t.baseURL,t.url,t.allowAbsoluteUrls);return cn(n,t.params,t.paramsSerializer)}};c.forEach(["delete","get","head","options"],function(t){yt.prototype[t]=function(n,s){return this.request(mt(s||{},{method:t,url:n,data:(s||{}).data}))}});c.forEach(["post","put","patch"],function(t){function n(s){return function(o,i,l){return this.request(mt(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}yt.prototype[t]=n(),yt.prototype[t+"Form"]=n(!0)});let pa=class wn{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const s=this;this.promise.then(a=>{if(!s._listeners)return;let o=s._listeners.length;for(;o-- >0;)s._listeners[o](a);s._listeners=null}),this.promise.then=a=>{let o;const i=new Promise(l=>{s.subscribe(l),o=l}).then(a);return i.cancel=function(){s.unsubscribe(o)},i},t(function(o,i,l){s.reason||(s.reason=new _t(o,i,l),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new wn(function(a){t=a}),cancel:t}}};function ha(e){return function(n){return e.apply(null,n)}}function ba(e){return c.isObject(e)&&e.isAxiosError===!0}const te={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(te).forEach(([e,t])=>{te[t]=e});function _n(e){const t=new yt(e),n=Ke(yt.prototype.request,t);return c.extend(n,yt.prototype,t,{allOwnKeys:!0}),c.extend(n,t,null,{allOwnKeys:!0}),n.create=function(a){return _n(mt(e,a))},n}const J=_n($t);J.Axios=yt;J.CanceledError=_t;J.CancelToken=pa;J.isCancel=fn;J.VERSION=vn;J.toFormData=qt;J.AxiosError=q;J.Cancel=J.CanceledError;J.all=function(t){return Promise.all(t)};J.spread=ha;J.isAxiosError=ba;J.mergeConfig=mt;J.AxiosHeaders=et;J.formToJSON=e=>dn(c.isHTMLForm(e)?new FormData(e):e);J.getAdapter=mn.getAdapter;J.HttpStatusCode=te;J.default=J;const{Axios:Vr,AxiosError:Gr,CanceledError:Jr,isCancel:Wr,CancelToken:Yr,VERSION:Kr,all:Xr,Cancel:Zr,isAxiosError:Qr,spread:ti,toFormData:ei,AxiosHeaders:ni,HttpStatusCode:si,formToJSON:ai,getAdapter:oi,mergeConfig:ri}=J,ga={class:"tab-container"},ya={class:"tab-list"},ma=["onClick"],va=Ft({__name:"tab",props:{tabList:{},defaultTab:{}},emits:["update:tab"],setup(e,{emit:t}){var i;const n=e,s=t,a=$(n.defaultTab||((i=n.tabList[0])==null?void 0:i.value)||"");it(()=>n.defaultTab,l=>{l&&(a.value=l)});const o=l=>{a.value=l.value,s("update:tab",l.value)};return(l,h)=>(L(),O("div",ga,[r("div",ya,[(L(!0),O(ot,null,bt(l.tabList,(u,d)=>(L(),O("div",{key:d,class:H(["tab-item",{active:a.value===u.value}]),onClick:p=>o(u)},I(u.label),11,ma))),128))])]))}}),kn=ft(va,[["__scopeId","data-v-bdec3bfa"]]),wa={class:"title"},_a={style:{transform:"rotate(180deg)"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"32302",width:"16",height:"16"},ka={class:"title-text"},Ea=Ft({__name:"title",props:{title:{},backs:{}},emits:["back"],setup(e,{emit:t}){const n=t,s=()=>{console.log("返回上一个"),n("back")};return(a,o)=>(L(),O("div",wa,[a.backs?(L(),O("div",{key:0,class:"back-btn",onClick:s},[(L(),O("svg",_a,o[0]||(o[0]=[r("path",{"data-v-da8ede72":"",d:"M722.438 510.815c-0.246-0.246-0.513-0.454-0.766-0.69l-299.893-299.892c-14.231-14.24-37.291-14.24-51.529 0-14.241 14.231-14.241 37.291 0 51.529l274.851 274.859-274.849 274.851c-14.241 14.237-14.241 37.301 0 51.532 7.116 7.119 16.436 10.682 25.764 10.682 9.321 0 18.644-3.563 25.763-10.682l299.905-299.901c0.246-0.234 0.51-0.438 0.751-0.678 7.129-7.13 10.685-16.469 10.674-25.804 0.006-9.337-3.55-18.676-10.674-25.804z",fill:"#ffffff","p-id":"32303"},null,-1)])))])):rt("",!0),r("div",ka,I(a.title),1)]))}}),Sa=ft(Ea,[["__scopeId","data-v-607b620a"]]),Je=e=>new Date(e).toLocaleString().replace(/\//g,"-"),ii=e=>!isNaN(e)&&Number.isFinite(Number(e))&&String(e).includes(".")?Number(e).toFixed(2):e,li=(e=new Date)=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${s}`},dt="http://localhost:8000",Wt="http://localhost:8001",kt=En("api",()=>{const e=$(""),t=$(""),n=$(null);$(null);const s=$("strategy"),a=$("strategy"),o=$(null),i=$("month"),l=$(""),h=$(""),u=$(null),d=$(null),p=$(null),_=$(null),g=$(null),b=$(null),S=$(null),k=$(null),R=$(null),y=De({backtestTrade:!1,backtestAccount:!1,backtestProfit:!1,backtestPosition:!1,backtestData:!1,factorList:!1,factorAnalysisResult:!1,backtestList:!1,lastRunId:!1,backtestLastRunId:!1,factorLastDateData:!1}),w=De({backtestTrade:null,backtestAccount:null,backtestProfit:null,backtestPosition:null,backtestData:null,factorList:null,factorAnalysisResult:null,backtestList:null,lastRunId:null,backtestLastRunId:null,factorLastDateData:null}),M=()=>{const E=localStorage.getItem("token");if(!E)throw new Error("认证令牌未找到");return E};return{log_workflow_id:e,log_workflow_run_id:t,klineChartRef:n,currentFootTab:s,child_currentFootTab:a,rightTableData:o,backtestTrade:u,backtestAccount:d,backtestProfit:p,backtestPosition:_,backtestData:g,factorList:b,factorAnalysisResult:S,backtestList:k,factorLastDateData:R,loading:y,error:w,timeRange:i,startDate:l,endDate:h,getToken:M,fetchBacktestTrade:async(E,m=1,A=10)=>{y.backtestTrade=!0,w.backtestTrade=null;try{const v=M(),F=`${dt}/api/backtest/trade?back_id=${E}&page=${m}&page_size=${A}`,B=await fetch(F,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${v}`}});if(!B.ok)throw new Error(`HTTP 错误! 状态: ${B.status}`);return u.value=await B.json(),u.value}catch(v){throw console.error("获取回测交易数据失败:",v),w.backtestTrade=v instanceof Error?v:new Error(String(v)),v}finally{y.backtestTrade=!1}},fetchBacktestAccount:async(E,m=1,A=10)=>{y.backtestAccount=!0,w.backtestAccount=null;try{const v=M(),F=`${dt}/api/backtest/account?back_id=${E}&page=${m}&page_size=${A}`,B=await fetch(F,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${v}`}});if(!B.ok)throw new Error(`HTTP 错误! 状态: ${B.status}`);return d.value=await B.json(),d.value}catch(v){throw console.error("获取回测账户数据失败:",v),w.backtestAccount=v instanceof Error?v:new Error(String(v)),v}finally{y.backtestAccount=!1}},fetchBacktestProfit:async E=>{y.backtestProfit=!0,w.backtestProfit=null;try{const m=M(),A=`${dt}/api/backtest/profit?back_id=${E}&page_size=10000`,v=await fetch(A,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${m}`}});if(!v.ok)throw new Error(`HTTP 错误! 状态: ${v.status}`);return p.value=await v.json(),p.value}catch(m){throw console.error("获取回测收益数据失败:",m),w.backtestProfit=m instanceof Error?m:new Error(String(m)),m}finally{y.backtestProfit=!1}},fetchBacktestPosition:async(E,m=1,A=10,v)=>{y.backtestPosition=!0,w.backtestPosition=null;try{const F=M(),B=`${dt}/api/backtest/position/?back_id=${E}&page=${m}&page_size=${A}&date=${v}`,K=await fetch(B,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${F}`}});if(!K.ok)throw new Error(`HTTP 错误! 状态: ${K.status}`);return _.value=await K.json(),_.value}catch(F){throw console.error("获取回测持仓数据失败:",F),w.backtestPosition=F instanceof Error?F:new Error(String(F)),F}finally{y.backtestPosition=!1}},fetchBacktestData:async E=>{y.backtestData=!0,w.backtestData=null;try{const m=M(),A=`${dt}/api/backtest/backtest?back_id=${E}`,v=await fetch(A,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`${m}`}});if(!v.ok)throw new Error(`HTTP 错误! 状态: ${v.status}`);return g.value=await v.json(),g.value}catch(m){throw console.error("获取回测单一数据失败:",m),w.backtestData=m instanceof Error?m:new Error(String(m)),m}finally{y.backtestData=!1}},fetchFactorList:async(E=1,m=100,A="factor")=>{y.factorList=!0,w.factorList=null;try{const v=M(),F=`${dt}/api/workflow/all?page=${E}&limit=${m}&filter=${A}`,B=await fetch(F,{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${v}`}});if(!B.ok)throw new Error(`HTTP 错误! 状态: ${B.status}`);return b.value=await B.json(),b.value}catch(v){throw console.error("获取因子列表失败:",v),w.factorList=v instanceof Error?v:new Error(String(v)),v}finally{y.factorList=!1}},fetchFactorAnalysisResult:async E=>{y.factorAnalysisResult=!0,w.factorAnalysisResult=null;try{const m=M(),A=`${dt}/api/workflow/run/output?output_obj_id=${E}`,v=await fetch(A,{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${m}`}});if(!v.ok)throw new Error(`HTTP 错误! 状态: ${v.status}`);return S.value=await v.json(),S.value}catch(m){throw console.error("获取因子分析结果失败:",m),w.factorAnalysisResult=m instanceof Error?m:new Error(String(m)),m}finally{y.factorAnalysisResult=!1}},fetchBacktestList:async(E=1,m=100,A="backtest")=>{y.backtestList=!0,w.backtestList=null;try{const v=M(),F=`${dt}/api/workflow/all?page=${E}&limit=${m}&filter=${A}`,B=await fetch(F,{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${v}`}});if(!B.ok)throw new Error(`HTTP 错误! 状态: ${B.status}`);return k.value=await B.json(),k.value}catch(v){throw console.error("获取策略回测列表失败:",v),w.backtestList=v instanceof Error?v:new Error(String(v)),v}finally{y.backtestList=!1}},fetchLastRunId:async(E,m,A)=>{y.lastRunId=!0,w.lastRunId=null;try{const v=M(),F=`${dt}/api/workflow/run/output/by-last-run?workflow_id=${E}&feature_tag=${m}&locator=${A}`,B=await fetch(F.toString(),{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${v}`}});if(!B.ok)throw new Error(`HTTP 错误! 状态: ${B.status}`);return await B.json()}catch(v){throw console.error("获取因子列表最后运行ID失败:",v),w.lastRunId=v instanceof Error?v:new Error(String(v)),v}finally{y.lastRunId=!1}},fetchBacktestLastRunId:async(E,m,A)=>{y.backtestLastRunId=!0,w.backtestLastRunId=null;try{const v=M(),F=`${dt}/api/workflow/run/output/by-last-run?workflow_id=${E}&feature_tag=${m}&locator=${A}`,B=await fetch(F.toString(),{method:"GET",headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:`${v}`}});if(!B.ok)throw new Error(`HTTP 错误! 状态: ${B.status}`);return await B.json()}catch(v){throw console.error("获取回测列表最后运行ID失败:",v),w.backtestLastRunId=v instanceof Error?v:new Error(String(v)),v}finally{y.backtestLastRunId=!1}},getFactorEarnings:async E=>{try{const m=await fetch(`${Wt}/api/v1/query_one_group_data?task_id=${E}`);if(!(m!=null&&m.ok))throw new Error("请求失败：未收到响应");return await m.json()}catch(m){throw m}},getFactorEarningsChart:async E=>{try{const m=await fetch(`${Wt}/api/v1/query_simple_return_chart?task_id=${E}`);if(!(m!=null&&m.ok))throw new Error("请求失败：未收到响应");return await m.json()}catch(m){throw m}},getFactorLastDateData:async E=>{var m,A;y.factorLastDateData=!0,w.factorLastDateData=null;try{const v=localStorage.getItem("token"),F=localStorage.getItem("userid"),B=await fetch(`${Wt}/api/v1/query_last_date_top_factor?task_id=${E}`,{headers:{Authorization:`${v}`,userId:`${F}`,"Content-Type":"application/json"}});if(!(B!=null&&B.ok))throw new Error("请求失败：未收到响应");const K=await B.json();return(A=(m=K.data)==null?void 0:m.last_date_top_factor)==null||A.forEach(ct=>{ct.code=ct.symbol.split(".")[1]}),R.value=K,K}catch(v){throw console.error("获取因子最新日期数据失败:",v),w.factorLastDateData=v instanceof Error?v:new Error(String(v)),v}finally{y.factorLastDateData=!1}},updateTimeRange:(E,m,A)=>{i.value=E,l.value=m,h.value=A}}}),Ca={class:"no-use-container"},Ta={key:0,class:"no-use-container-img"},Ra={key:1,class:"no-data-container-img"},$a=Ft({__name:"tip",props:{type:{type:String,default:"no-use"},title:{type:String,default:"该功能暂未开放，敬请期待"}},setup(e){return(t,n)=>(L(),O("div",Ca,[e.type==="no-use"?(L(),O("div",Ta)):rt("",!0),e.type==="no-data"?(L(),O("div",Ra)):rt("",!0),r("p",null,I(e.title),1),Sn(t.$slots,"default",{},void 0,!0)]))}}),xa=ft($a,[["__scopeId","data-v-40772042"]]),Aa={key:0,class:"table-container"},Da={class:"table-wrapper"},Pa={class:"custom-table"},La=["title"],Oa={class:"name-cell table-cell"},Fa=["onBlur","onKeyup"],ja=["title"],Na=["onClick"],Ba={class:"table-cell"},Ia={class:"table-cell"},qa={style:{"text-align":"right"}},Ua=["onClick"],Ma=["onClick"],za={key:0,class:"loading-spinner"},Ha={class:"pagination"},Va={class:"page-nav"},Ga=["disabled"],Ja={style:{transform:"rotate(180deg)"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"32302",width:"16",height:"16"},Wa={key:0,class:"dots"},Ya=["onClick"],Ka=["disabled"],Xa={style:{transform:"rotate(0deg)"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"32302",width:"16",height:"16"},Za={key:1,class:"table-container"},Qa={key:2,class:"table-container"},to={__name:"tablea",props:{tableData:{type:Array,default:()=>[]}},emits:["apply"],setup(e,{expose:t,emit:n}){const s=We(),a=n,o=kt(),i=Cn(),l=T=>{T?i.push(`/editor?workflow_id=${T}`):i.push("/editor")};$(!1);const h=$(null),u=$(""),d=e,p=pt(()=>!d.tableData||!d.tableData.data||!d.tableData.data.workflows?[]:d.tableData.data.workflows.map(T=>({id:T._id,name:T.name,createTime:Je(T.create_at),modifyTime:Je(T.update_at),item:T}))),_=$([]);it(p,T=>{_.value=T},{immediate:!0});const g=$(1),b=$(10),S=pt(()=>_.value.length),k=pt(()=>Math.ceil(S.value/b.value)),R=pt(()=>{const T=(g.value-1)*b.value,D=T+b.value;return _.value.slice(T,D)}),y=pt(()=>{const T=[],D=k.value,x=g.value;if(D<=5){for(let V=1;V<=D;V++)T.push(V);return T}if(T.push(1),x>3&&T.push("..."),x===1||x===2)T.includes(2)||T.push(2),T.includes(3)||T.push(3);else if(x===D||x===D-1)for(let V=D-2;V<D;V++)T.includes(V)||T.push(V);else T.push(x-1,x,x+1);return x<D-2&&T.push("..."),T.includes(D)||T.push(D),[...new Set(T)]}),w=T=>{T!=="..."&&(g.value=T)},M=()=>{g.value>1&&g.value--},U=()=>{g.value<k.value&&g.value++},G=$(null),Q=async T=>{var D;h.value=T.id,u.value=T.name,await xn(),(D=G.value)==null||D.focus()},C=async T=>{if(!u.value.trim()){s.error("名称不能为空"),u.value=T.name;return}if(u.value===T.name){h.value=null;return}try{await Ln(T.id,u.value);const D=_.value.findIndex(x=>x.id===T.id);D!==-1&&(_.value[D].name=u.value),h.value=null,s.success("名称修改成功")}catch(D){console.error("重命名失败:",D),u.value=T.name,s.error("名称修改失败，请稍后重试")}},f=()=>{h.value=null,u.value=""},j=$({}),N=(T,D)=>{j.value[D]=!0,o.log_workflow_id=T._id,o.log_workflow_run_id=T.last_run_id,a("apply",{workflow_id:T._id,title:T.name,feature_tag:"backtest",locator:"backtest_id",last_run_id:T.last_run_id}),setTimeout(()=>{j.value[D]=!1},5e3),console.log("应用项目1：",T)},W=T=>{T?j.value[T]=!1:Object.keys(j.value).forEach(D=>{j.value[D]=!1})};return it(p,()=>{W()},{deep:!0}),t({resetLoadingState:W}),(T,D)=>_.value.length>0?(L(),O("div",Aa,[r("div",Da,[r("table",Pa,[D[3]||(D[3]=r("thead",null,[r("tr",null,[r("th",null,"ID"),r("th",null,"名称"),r("th",null,"创建时间"),r("th",null,"修改时间"),r("th")])],-1)),r("tbody",null,[(L(!0),O(ot,null,bt(R.value,(x,V)=>(L(),O("tr",{key:x.id},[r("td",{class:"table-cell",title:x.id},I(x.id),9,La),r("td",Oa,[h.value===x.id?ht((L(),O("input",{key:0,"onUpdate:modelValue":D[0]||(D[0]=Y=>u.value=Y),type:"text",class:"edit-input",onBlur:Y=>C(x),onKeyup:[Pe(Y=>C(x),["enter"]),Pe(f,["esc"])],ref_for:!0,ref_key:"editInput",ref:G},null,40,Fa)),[[Tn,u.value]]):(L(),O(ot,{key:1},[r("span",{class:"table-cell",title:x.name},I(x.name),9,ja),x.owner!=="*"?(L(),O("span",{key:0,class:"copy-icon",onClick:Y=>Q(x)},D[2]||(D[2]=[Rn('<svg width="12px" height="12px" viewBox="0 0 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" data-v-9ac5c232><title data-v-9ac5c232>修改名称</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" data-v-9ac5c232><g id="超级图表-工作流" transform="translate(-364, -729)" fill="#2767EE" fill-rule="nonzero" data-v-9ac5c232><g id="编辑" transform="translate(364, 729)" data-v-9ac5c232><path d="M5.98554217,5.31036145 L10.9359036,0.361445783 C11.1310843,0.16626506 11.4477108,0.16626506 11.6428916,0.361445783 C11.8380723,0.556626506 11.8380723,0.873253012 11.6428916,1.06843373 L6.69253012,6.0173494 C6.4973494,6.21253012 6.18072289,6.21253012 5.98554217,6.0173494 C5.79036145,5.82216867 5.79036145,5.50554217 5.98554217,5.31036145 Z M10.9995181,5.83373494 C10.9995181,5.55759036 11.2236145,5.33349398 11.499759,5.33349398 C11.7759036,5.33349398 12,5.55759036 12,5.83373494 L12,9.50024096 C12,10.8809639 10.8809639,12 9.50024096,12 L2.49975904,12 C1.11903614,12 0,10.8809639 0,9.50024096 L0,2.49975904 C0,1.11903614 1.11903614,0 2.49975904,0 L6.16626506,0 C6.44240964,0 6.66650602,0.224096386 6.66650602,0.500240964 C6.66650602,0.776385542 6.44240964,1.00048193 6.16626506,1.00048193 L2.49975904,1.00048193 C1.6713253,1.00048193 1.00048193,1.67277108 1.00048193,2.49975904 L1.00048193,9.50024096 C1.00048193,10.3286747 1.67277108,11.0009639 2.49975904,11.0009639 L9.50024096,11.0009639 C10.3286747,11.0009639 11.0009639,10.3286747 11.0009639,9.50024096 L11.0009639,5.83373494 L10.9995181,5.83373494 Z" id="形状" data-v-9ac5c232></path></g></g></g></svg>',1)]),8,Na)):rt("",!0)],64))]),r("td",Ba,I(x.createTime),1),r("td",Ia,I(x.modifyTime),1),r("td",qa,[r("button",{class:H(["apply-btn"]),onClick:Y=>l(x.id),style:{"margin-right":"10px"}}," 编辑 ",8,Ua),r("button",{class:H(["apply-btn",{loading:j.value[x.id]}]),onClick:Y=>N(x.item,x.id)},[vt(I(j.value[x.id]?"正在应用":"应用")+" ",1),j.value[x.id]?(L(),O("span",za)):rt("",!0)],10,Ma)])]))),128))])])]),r("div",Ha,[r("div",Va,[r("button",{disabled:g.value===1,onClick:M},[(L(),O("svg",Ja,D[4]||(D[4]=[r("path",{"data-v-da8ede72":"",d:"M722.438 510.815c-0.246-0.246-0.513-0.454-0.766-0.69l-299.893-299.892c-14.231-14.24-37.291-14.24-51.529 0-14.241 14.231-14.241 37.291 0 51.529l274.851 274.859-274.849 274.851c-14.241 14.237-14.241 37.301 0 51.532 7.116 7.119 16.436 10.682 25.764 10.682 9.321 0 18.644-3.563 25.763-10.682l299.905-299.901c0.246-0.234 0.51-0.438 0.751-0.678 7.129-7.13 10.685-16.469 10.674-25.804 0.006-9.337-3.55-18.676-10.674-25.804z",fill:"#ffffff","p-id":"32303"},null,-1)])))],8,Ga),(L(!0),O(ot,null,bt(y.value,(x,V)=>(L(),O(ot,{key:V},[x==="..."?(L(),O("span",Wa,"...")):(L(),O("button",{key:1,class:H({active:x===g.value}),onClick:Y=>w(x)},I(x),11,Ya))],64))),128)),r("button",{disabled:g.value===k.value,onClick:U},[(L(),O("svg",Xa,D[5]||(D[5]=[r("path",{"data-v-da8ede72":"",d:"M722.438 510.815c-0.246-0.246-0.513-0.454-0.766-0.69l-299.893-299.892c-14.231-14.24-37.291-14.24-51.529 0-14.241 14.231-14.241 37.291 0 51.529l274.851 274.859-274.849 274.851c-14.241 14.237-14.241 37.301 0 51.532 7.116 7.119 16.436 10.682 25.764 10.682 9.321 0 18.644-3.563 25.763-10.682l299.905-299.901c0.246-0.234 0.51-0.438 0.751-0.678 7.129-7.13 10.685-16.469 10.674-25.804 0.006-9.337-3.55-18.676-10.674-25.804z",fill:"#ffffff","p-id":"32303"},null,-1)])))],8,Ka)])])])):_.value.length===0&&!z(o).loading.backtestList?(L(),O("div",Za,[at(xa,{type:"no-data",title:"暂无数据，快创建自己的工作流吧。"},{default:$n(()=>[r("div",{class:"content-btn active",onClick:D[1]||(D[1]=x=>l())},"创建工作流")]),_:1})])):(L(),O("div",Qa,[at(ee,{visible:z(o).loading.backtestList},null,8,["visible"])]))}},eo=ft(to,[["__scopeId","data-v-9ac5c232"]]),no={class:"modal-content"},so={class:"modal-header"},ao={class:"tabs"},oo={class:"toolbar"},ro={class:"checkbox-group"},io={class:"custom-checkbox"},lo={class:"custom-checkbox"},co={class:"custom-checkbox"},uo={class:"custom-checkbox"},fo={class:"log-viewer"},po={class:"log-content"},ho={class:"timestamp"},bo={class:"level"},go={class:"message"},yo={class:"placeholder-content"},mo={class:"placeholder-content"},vo={__name:"logs",setup(e,{expose:t}){const n=kt(),s=async(R=!1,y="")=>{try{if(!n.log_workflow_run_id||!n.log_workflow_id)return null;const w=localStorage.getItem("token"),M={workflow_run_id:n.log_workflow_run_id,workflow_id:n.log_workflow_id,limit:100};R&&(M.last_sequence=R),y&&(M.log_level=y);const U=await J.get("http://localhost:8000/api/workflow/run/log",{params:M,headers:{uid:"0","quantflow-auth":"2","Content-Type":"application/json",Authorization:w}});return U.data&&U.data.code===0&&U.data.data&&U.data.data.logs?(g.value=U.data.data.logs.map(G=>({timestamp:new Date(G.timestamp).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),level:G.level,message:G.message,work_node_id:G.work_node_id,sequence:G.sequence})),{hasMore:U.data.data.has_more,nextLogId:U.data.data.next_log_id,nextSequence:U.data.data.next_sequence,totalCount:U.data.data.total_count}):null}catch(w){return console.error("Failed to fetch logs:",w),null}},a=async()=>{try{const R=await s(!1,"");R&&console.log("Page info:",R)}catch(R){console.error("Failed to refresh logs:",R)}};let o=null;const i=()=>{o||(o=setInterval(a,5e3))},l=()=>{o&&(clearInterval(o),o=null)};Tt(()=>{a(),i()}),Ye(()=>{l()});const h=[{label:"日志",value:"logs"}],u=$("logs"),d=R=>{console.log("当前选中的tab:",R),u.value=R},p=$(!1),_=$(["INFO","WARN","DEBUG","ERROR"]),g=$([{timestamp:"2025-06-04 13:30:01",level:"ERROR",message:"多头持仓"},{timestamp:"2025-06-04 13:30:01",level:"INFO",message:"当前无仓位需要进行调整"},{timestamp:"2025-06-04 13:30:01",level:"INFO",message:"开始进行批量下单"},{timestamp:"2025-06-04 13:30:01",level:"ERROR",message:"按目标调仓"},{timestamp:"2025-06-04 13:30:01",level:"WARN",message:"[{'AL2507.SHF': 4.0, 'AU2508.SHF': 2.0, 'BU2507.SHF': 6.0, 'CU2507.SHF': 1.0, 'IF2509.CFE': 1.0, 'IH2509.CFE': 1.0, 'L2509.DCE': 9.0, 'RU2509.SHF': 2.0, 'T2509.CFE': 2.0, 'TF2509.CFE': 4.0, 'TL2509.CFE': 1.0, 'TS2509.CFE': 5.0, 'ZN2507.SHF': 3.0}]"},{timestamp:"2025-06-04 13:30:01",level:"ERROR",message:"无对冲信号"}]),b=pt(()=>g.value.filter(R=>_.value.includes(R.level))),S=()=>{p.value=!0,i()},k=()=>{p.value=!1,l()};return t({openDialog:S,closeDialog:k}),(R,y)=>p.value?(L(),O("div",{key:0,class:"modal-overlay",onClick:An(k,["self"])},[r("div",no,[r("div",so,[r("div",ao,[at(kn,{"tab-list":h,tab:u.value,"onUpdate:tab":[y[0]||(y[0]=w=>u.value=w),d]},null,8,["tab"])]),r("div",oo,[r("div",ro,[r("label",io,[ht(r("input",{type:"checkbox",value:"INFO","onUpdate:modelValue":y[1]||(y[1]=w=>_.value=w)},null,512),[[xt,_.value]]),y[5]||(y[5]=r("span",{class:"checkmark"},null,-1)),y[6]||(y[6]=vt(" INFO "))]),r("label",lo,[ht(r("input",{type:"checkbox",value:"WARN","onUpdate:modelValue":y[2]||(y[2]=w=>_.value=w)},null,512),[[xt,_.value]]),y[7]||(y[7]=r("span",{class:"checkmark"},null,-1)),y[8]||(y[8]=vt(" WARN "))]),r("label",co,[ht(r("input",{type:"checkbox",value:"DEBUG","onUpdate:modelValue":y[3]||(y[3]=w=>_.value=w)},null,512),[[xt,_.value]]),y[9]||(y[9]=r("span",{class:"checkmark"},null,-1)),y[10]||(y[10]=vt(" DEBUG "))]),r("label",uo,[ht(r("input",{type:"checkbox",value:"ERROR","onUpdate:modelValue":y[4]||(y[4]=w=>_.value=w)},null,512),[[xt,_.value]]),y[11]||(y[11]=r("span",{class:"checkmark"},null,-1)),y[12]||(y[12]=vt(" ERROR "))])]),r("button",{class:"button",onClick:a,style:{border:"0"}},y[13]||(y[13]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round",class:"refresh-icon"},[r("path",{d:"M23 4v6h-6"}),r("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})],-1),vt(" 刷新 ")]))]),r("button",{class:"close-button",onClick:k},"×")]),ht(r("div",fo,[r("div",po,[(L(!0),O(ot,null,bt(b.value,(w,M)=>(L(),O("div",{key:M,class:H(["log-entry",w.level.toLowerCase()])},[r("span",ho,"["+I(w.timestamp)+"]",1),r("span",bo,"-"+I(w.level)+"-",1),r("span",go,I(w.message),1)],2))),128))])],512),[[zt,u.value==="logs"]]),ht(r("div",yo," 风控日志内容... ",512),[[zt,u.value==="risk"]]),ht(r("div",mo," 错误日志内容... ",512),[[zt,u.value==="errors"]])])])):rt("",!0)}},wo=ft(vo,[["__scopeId","data-v-7de486e1"]]),_o={class:"chart-container"},ko={class:"header"},Eo={class:"metrics"},So={class:"metric"},Co={class:"metric"},To={class:"metric"},Ro={class:"metric"},$o={class:"metric"},xo={class:"metric"},Ao={class:"metric"},Do={class:"metric"},Po={class:"metric"},Lo={class:"metric"},Oo={class:"metric"},Fo={class:"chart-box"},jo={class:"time-controls"},No={class:"time-buttons"},Bo={class:"date-picker"},Io={class:"date-picker"},qo={class:"chart-legend"},Uo={__name:"aa",props:{back_id:{type:String,required:!0}},setup(e){const t=kt(),n=e,s=$(null);let a=null,o=null;const i=$("month"),l=$(""),h=$(""),u=$(1),d=$(10),p=$([]),_=$(new Set),g=$({strategyProfit:!0,benchmarkProfit:!0,excessProfit:!0,dayProfit:!0,dayTrade:!0}),b=C=>{g.value[C]=!g.value[C],G()};pt(()=>{const C=parseInt(u.value);return C===1?"日":C===2?"2日":C===3?"3日":C===5?"周":C===10?"2周":`${C}日`});const S=C=>{if(typeof C=="string"&&C.length===8)return`${C.slice(0,4)}-${C.slice(4,6)}-${C.slice(6,8)}`;if(C instanceof Date){const f=C.getFullYear(),j=String(C.getMonth()+1).padStart(2,"0"),N=String(C.getDate()).padStart(2,"0");return`${f}-${j}-${N}`}if(typeof C=="number"){const f=new Date(C);return S(f)}return""},k=C=>{if(!C||!_.value.size)return!1;const f=S(C);return console.log("Checking date:",f,"Available:",_.value.has(f)),!_.value.has(f)};it(()=>n.back_id,async()=>{var C,f;if(n.back_id&&(console.log("回测数据back_id：",n.back_id),await t.fetchBacktestData(n.back_id),console.log("回测数据：",t.backtestData),await t.fetchBacktestProfit(n.back_id),console.log("回测收益数据：",t.backtestProfit),(f=(C=t.backtestProfit)==null?void 0:C.data)!=null&&f.items)){if(p.value=t.backtestProfit.data.items,console.log("Sample date format:",{firstItem:p.value[0],dateType:typeof p.value[0].gmt_create,dateValue:p.value[0].gmt_create}),_.value=new Set(p.value.map(j=>S(j.gmt_create))),console.log("Available dates:",Array.from(_.value)),p.value.length>0){const j=Array.from(_.value).sort();l.value=j[0],h.value=j[j.length-1],console.log("Set date range:",{start:l.value,end:h.value})}G()}},{immediate:!0}),it([l,h],([C,f])=>{C&&f&&(t.updateTimeRange(i.value,C,f),G())},{immediate:!0});const R=(C,f=!1,j=2)=>C==null?f?"0.00%":"0.0000":f?(C*100).toFixed(j)+"%":C.toFixed(j),y=C=>C>0?"positive":C<0?"negative":"",w=C=>{if(i.value=C,!p.value||p.value.length===0)return;const f=p.value.map(T=>S(T.gmt_create)),j=f[f.length-1],N=new Date(j);let W=new Date(j);switch(C){case"month":W.setMonth(N.getMonth()-1);break;case"quarter":W.setMonth(N.getMonth()-3);break;case"halfYear":W.setMonth(N.getMonth()-6);break;case"year":W.setFullYear(N.getFullYear()-1);break;case"ytd":W=new Date(N.getFullYear(),0,1);break;case"all":W=new Date(f[0]);break}l.value=W.toISOString().split("T")[0],h.value=j,t.updateTimeRange(C,l.value,h.value),G()},M=()=>{t.updateTimeRange(i.value,l.value,h.value),G()},U=(C,f)=>{if(f<=1||!C||C.length===0)return C;const j=[];let N=[];return C.forEach((W,T)=>{if(T%f===0&&T!==0){const D={gmt_create:N[0].gmt_create,gmt_create_time:N[0].gmt_create_time,strategy_profit:N[N.length-1].strategy_profit,csi_stock:N[N.length-1].csi_stock,overful_profit:N[N.length-1].overful_profit,day_profit:N.reduce((x,V)=>x+V.day_profit,0),day_purchase:N.reduce((x,V)=>x+V.day_purchase,0),day_put:N.reduce((x,V)=>x+V.day_put,0)};j.push(D),N=[]}if(N.push(W),T===C.length-1&&N.length>0){const D={gmt_create:N[0].gmt_create,gmt_create_time:N[0].gmt_create_time,strategy_profit:N[N.length-1].strategy_profit,csi_stock:N[N.length-1].csi_stock,overful_profit:N[N.length-1].overful_profit,day_profit:N.reduce((x,V)=>x+V.day_profit,0),day_purchase:N.reduce((x,V)=>x+V.day_purchase,0),day_put:N.reduce((x,V)=>x+V.day_put,0)};j.push(D)}}),j},G=()=>{if(!s.value||!p.value||p.value.length===0)return;let C=p.value;l.value&&h.value&&(C=p.value.filter(E=>{const m=S(E.gmt_create);return m>=l.value&&m<=h.value}));const f=parseInt(u.value),j=U(C,f),N=j.map(E=>S(E.gmt_create)),W=j.map(E=>E.strategy_profit*100),T=j.map(E=>E.csi_stock*100),D=j.map(E=>E.overful_profit*100),x=j.map(E=>({value:Math.abs(E.day_profit),itemStyle:{color:E.day_profit>=0?"#2dc08e":"#f92855"}})),V=j.map(E=>({value:Math.max(Math.abs(E.day_purchase),Math.abs(E.day_put)),itemStyle:{color:E.day_purchase>0?"#2dc08e":"#f92855"}})),Y=[];g.value.strategyProfit&&Y.push({name:"策略收益",type:"line",symbol:"none",data:W,lineStyle:{color:"#29a5ff"},itemStyle:{color:"#29a5ff"},areaStyle:{color:new Ht(0,0,0,1,[{offset:0,color:"rgba(141,165,255, 0)"},{offset:1,color:"rgba(141,165,255, 0.3)"}])}}),g.value.benchmarkProfit&&Y.push({name:"基准收益",type:"line",symbol:"none",data:T,lineStyle:{color:"#38B6B6"},itemStyle:{color:"#38B6B6"},areaStyle:{color:new Ht(0,0,0,1,[{offset:0,color:"rgba(56,182,182, 0.3)"},{offset:1,color:"rgba(56,182,182, 0)"}])}}),g.value.excessProfit&&Y.push({name:"超额收益",type:"line",symbol:"none",data:D,lineStyle:{color:"#9D4EDD"},itemStyle:{color:"#9D4EDD"},areaStyle:{color:new Ht(0,0,0,1,[{offset:0,color:"rgba(157,78,221, 0)"},{offset:1,color:"rgba(157,78,221, 0.3)"}])}}),g.value.dayProfit&&Y.push({name:"当日盈亏",type:"bar",xAxisIndex:1,yAxisIndex:1,data:x}),g.value.dayTrade&&Y.push({name:"当日买卖",type:"bar",xAxisIndex:1,yAxisIndex:1,barGap:"30%",data:V});const P={backgroundColor:"#14151A",tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(E){let m=E[0].axisValue+"<br/>";return E.forEach(A=>{let v=A.color;typeof v!="string"&&(v=A.color.colorStops?A.color.colorStops[0].color:"#fff");let F=A.value;if(A.seriesName==="策略收益"||A.seriesName==="基准收益"||A.seriesName==="超额收益")F=F.toFixed(4)+"%";else if(A.seriesName==="当日盈亏"){const B=A.dataIndex;F=j[B].day_profit.toFixed(2)}else if(A.seriesName==="当日买卖"){const B=A.dataIndex,K=j[B].day_purchase,ct=j[B].day_put;F=`买入: ${K}, 卖出: ${ct}`}m+=`<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${v};"></span> ${A.seriesName}: ${F}<br/>`}),m}},grid:[{left:"4%",right:"2%",height:"50%",top:"5%"},{left:"4%",right:"2%",top:"65%",height:"25%",bottom:"10%"}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",bottom:"2%",height:15,start:0,end:100,handleSize:10,borderColor:"#666",backgroundColor:"rgba(134, 27, 206, 0.3)"}],xAxis:[{type:"category",data:N,axisLine:{lineStyle:{color:"#333"}},axisLabel:{color:"#999"}},{gridIndex:1,type:"category",data:N,axisLine:{lineStyle:{color:"#333"}},axisLabel:{color:"#999",showMaxLabel:!0}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:"#333"}},axisLabel:{color:"#999",formatter:"{value}%"},splitLine:{lineStyle:{color:"#222"}}},{gridIndex:1,type:"value",axisLine:{lineStyle:{color:"#333"}},axisLabel:{color:"#999",formatter:E=>(E/1e4).toFixed(0)+"w"},splitLine:{lineStyle:{color:"#222"}}}],series:Y};a||(a=Le(s.value),window.addEventListener("resize",()=>{a&&a.resize()})),a.setOption(P,!0)},Q=()=>{const C=document.querySelectorAll('[id^="el-popper-container-"]');console.log("找到popper元素数量:",C.length),C.forEach(f=>{f.style.position="relative",f.style.zIndex="99999999999999999",console.log(`已设置元素 ${f.id} 的样式`)})};return Tt(async()=>{var C,f;if(n.back_id&&(await t.fetchBacktestData(n.back_id),await t.fetchBacktestProfit(n.back_id),(f=(C=t.backtestProfit)==null?void 0:C.data)!=null&&f.items)){if(p.value=t.backtestProfit.data.items,p.value.length>0){const j=p.value.map(N=>S(N.gmt_create));l.value=j[0],h.value=j[j.length-1],d.value=Math.min(Math.floor(p.value.length/2),20)}w("all")}Q(),a=Le(s.value),o=new ResizeObserver(()=>{a==null||a.resize()}),s.value&&o.observe(s.value)}),Ye(()=>{o&&o.disconnect(),a&&(a.dispose(),a=null)}),(C,f)=>{var N,W,T,D,x,V,Y,P,E,m,A,v,F,B,K,ct,Et,nt,oe,re,ie,le,ce,ue,de,fe,pe,he,be,ge,ye,me,ve,we,_e,ke,Ee,Se,Ce,Te,Re,$e,xe,Ae;const j=Dn("el-date-picker");return L(),O("div",_o,[r("div",ko,[r("div",Eo,[r("div",So,[f[12]||(f[12]=r("span",{class:"label"},"收益",-1)),r("span",{class:H(["value",y((W=(N=z(t).backtestData)==null?void 0:N.data)==null?void 0:W.back_profit)])},I(R((D=(T=z(t).backtestData)==null?void 0:T.data)==null?void 0:D.back_profit,!0)),3)]),r("div",Co,[f[13]||(f[13]=r("span",{class:"label"},"年化收益",-1)),r("span",{class:H(["value",y((V=(x=z(t).backtestData)==null?void 0:x.data)==null?void 0:V.back_profit_year)])},I(R((P=(Y=z(t).backtestData)==null?void 0:Y.data)==null?void 0:P.back_profit_year,!0)),3)]),r("div",To,[f[14]||(f[14]=r("span",{class:"label"},"基准收益",-1)),r("span",{class:H(["value",y((m=(E=z(t).backtestData)==null?void 0:E.data)==null?void 0:m.benchmark_profit)])},I(R((v=(A=z(t).backtestData)==null?void 0:A.data)==null?void 0:v.benchmark_profit,!0)),3)]),r("div",Ro,[f[15]||(f[15]=r("span",{class:"label"},"信息比率",-1)),r("span",{class:H(["value",y((B=(F=z(t).backtestData)==null?void 0:F.data)==null?void 0:B.information_ratio)])},I(R((ct=(K=z(t).backtestData)==null?void 0:K.data)==null?void 0:ct.information_ratio,!1,4)),3)]),r("div",$o,[f[16]||(f[16]=r("span",{class:"label"},"夏普比率",-1)),r("span",{class:H(["value",y((nt=(Et=z(t).backtestData)==null?void 0:Et.data)==null?void 0:nt.sharpe)])},I(R((re=(oe=z(t).backtestData)==null?void 0:oe.data)==null?void 0:re.sharpe,!1,4)),3)]),r("div",xo,[f[17]||(f[17]=r("span",{class:"label"},"Alpha",-1)),r("span",{class:H(["value",y((le=(ie=z(t).backtestData)==null?void 0:ie.data)==null?void 0:le.alpha)])},I(R((ue=(ce=z(t).backtestData)==null?void 0:ce.data)==null?void 0:ue.alpha,!1,4)),3)]),r("div",Ao,[f[18]||(f[18]=r("span",{class:"label"},"Beta",-1)),r("span",{class:H(["value",y((fe=(de=z(t).backtestData)==null?void 0:de.data)==null?void 0:fe.beta)])},I(R((he=(pe=z(t).backtestData)==null?void 0:pe.data)==null?void 0:he.beta,!1,4)),3)]),r("div",Do,[f[19]||(f[19]=r("span",{class:"label"},"Sortino(索提诺比率)",-1)),r("span",{class:H(["value",y((ge=(be=z(t).backtestData)==null?void 0:be.data)==null?void 0:ge.sortino)])},I(R((me=(ye=z(t).backtestData)==null?void 0:ye.data)==null?void 0:me.sortino,!1,4)),3)]),r("div",Po,[f[20]||(f[20]=r("span",{class:"label"},"收益波动率",-1)),r("span",{class:H(["value",y((we=(ve=z(t).backtestData)==null?void 0:ve.data)==null?void 0:we.volatility)])},I(R((ke=(_e=z(t).backtestData)==null?void 0:_e.data)==null?void 0:ke.volatility,!0,2)),3)]),r("div",Lo,[f[21]||(f[21]=r("span",{class:"label"},"最大回撤",-1)),r("span",{class:H(["value",y((Se=(Ee=z(t).backtestData)==null?void 0:Ee.data)==null?void 0:Se.max_drawdown)])},I(R((Te=(Ce=z(t).backtestData)==null?void 0:Ce.data)==null?void 0:Te.max_drawdown,!0,2)),3)]),r("div",Oo,[f[22]||(f[22]=r("span",{class:"label"},"下行风险",-1)),r("span",{class:H(["value",y(($e=(Re=z(t).backtestData)==null?void 0:Re.data)==null?void 0:$e.downside_risk)])},I(R((Ae=(xe=z(t).backtestData)==null?void 0:xe.data)==null?void 0:Ae.downside_risk,!0,2)),3)])])]),r("div",Fo,[r("div",jo,[r("div",No,[r("button",{class:H({active:i.value==="month"}),onClick:f[0]||(f[0]=st=>w("month"))},"月",2),r("button",{class:H({active:i.value==="quarter"}),onClick:f[1]||(f[1]=st=>w("quarter"))},"季度",2),r("button",{class:H({active:i.value==="halfYear"}),onClick:f[2]||(f[2]=st=>w("halfYear"))},"半年",2),r("button",{class:H({active:i.value==="year"}),onClick:f[3]||(f[3]=st=>w("year"))},"年",2),r("button",{class:H({active:i.value==="all"}),onClick:f[4]||(f[4]=st=>w("all"))},"全部",2),r("div",Bo,[f[23]||(f[23]=r("span",null,"开始时间",-1)),at(j,{class:"date-picker-input-ns",modelValue:l.value,"onUpdate:modelValue":f[5]||(f[5]=st=>l.value=st),type:"date",placeholder:"选择开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:M,"disabled-date":k,size:"small"},null,8,["modelValue"])]),r("div",Io,[f[24]||(f[24]=r("span",null,"结束时间",-1)),at(j,{class:"date-picker-input-ns",modelValue:h.value,"onUpdate:modelValue":f[6]||(f[6]=st=>h.value=st),type:"date",placeholder:"选择结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:M,"disabled-date":k,size:"small"},null,8,["modelValue"])])]),r("div",qo,[r("div",{class:H(["legend-item",{inactive:!g.value.strategyProfit}]),onClick:f[7]||(f[7]=st=>b("strategyProfit"))},f[25]||(f[25]=[r("span",{class:"line-icon strategy-line"},null,-1),r("span",{class:"legend-text"},"策略收益",-1)]),2),r("div",{class:H(["legend-item",{inactive:!g.value.excessProfit}]),onClick:f[8]||(f[8]=st=>b("excessProfit"))},f[26]||(f[26]=[r("span",{class:"line-icon excess-line"},null,-1),r("span",{class:"legend-text"},"超额收益",-1)]),2),r("div",{class:H(["legend-item",{inactive:!g.value.benchmarkProfit}]),onClick:f[9]||(f[9]=st=>b("benchmarkProfit"))},f[27]||(f[27]=[r("span",{class:"line-icon benchmark-line"},null,-1),r("span",{class:"legend-text"},"基准收益",-1)]),2),r("div",{class:H(["legend-item",{inactive:!g.value.dayProfit}]),onClick:f[10]||(f[10]=st=>b("dayProfit"))},f[28]||(f[28]=[r("div",{class:"square-container"},[r("span",{class:"square-icon loss-square"}),r("span",{class:"square-icon profit-square"})],-1),r("span",{class:"legend-text"},"当日盈亏",-1)]),2),r("div",{class:H(["legend-item",{inactive:!g.value.dayTrade}]),onClick:f[11]||(f[11]=st=>b("dayTrade"))},f[29]||(f[29]=[r("div",{class:"square-container"},[r("span",{class:"square-icon sell-square"}),r("span",{class:"square-icon buy-square"})],-1),r("span",{class:"legend-text"},"当日买卖",-1)]),2)])]),r("div",{ref_key:"chartRef",ref:s,class:"chart"},null,512)])])}}},Mo=ft(Uo,[["__scopeId","data-v-c6267433"]]),zo={key:0,class:"table-container"},Ho={class:"table-container-inner"},Vo={class:"data-table"},Go={key:1,class:"table-container"},Jo={__name:"bb",props:{back_id:{type:String,required:!0},currentPage:{type:Number,default:1},pageSize:{type:Number,default:10}},emits:["update:pagination"],setup(e,{emit:t}){const n=kt(),s=e,a=t,o=$([]),i=$(1),l=$(0),h=g=>{if(!g)return"";const b=g.substring(0,4),S=g.substring(4,6),k=g.substring(6,8);return`${b}/${S}/${k}`},u=g=>{if(g==null)return"¥0.00";const b=g/100;return b<0?`-¥${Math.abs(b).toFixed(2)}`:`¥${b.toFixed(2)}`},d=g=>{switch(g){case 0:return"股票";case 1:return"期货";case 2:return"基金";default:return"未知"}},p=g=>{switch(g){case 0:return"stock";case 1:return"futures";case 2:return"fund";default:return""}},_=async()=>{try{await n.fetchBacktestTrade(s.back_id,s.currentPage,s.pageSize),n.backtestTrade&&n.backtestTrade.data&&(o.value=n.backtestTrade.data.items||[],n.backtestTrade.data.pagination&&(l.value=n.backtestTrade.data.pagination.total,i.value=n.backtestTrade.data.pagination.total_pages,a("update:pagination",{currentPage:n.backtestTrade.data.pagination.page,pageSize:n.backtestTrade.data.pagination.page_size,totalPages:i.value,totalItems:l.value})))}catch(g){console.error("获取回测交易数据失败",g)}};return it(()=>s.back_id,()=>{_()}),it(()=>s.currentPage,()=>{_()}),it(()=>s.pageSize,()=>{_()}),Tt(async()=>{await _()}),(g,b)=>o.value.length>0?(L(),O("div",zo,[r("div",Ho,[r("table",Vo,[b[0]||(b[0]=r("thead",null,[r("tr",null,[r("th",null,"标的"),r("th",null,"交易日期"),r("th",null,"交易类型"),r("th",null,"品种"),r("th",null,"方向"),r("th",null,"成交量"),r("th",null,"成交价格"),r("th",null,"费用")])],-1)),r("tbody",null,[(L(!0),O(ot,null,bt(o.value,(S,k)=>(L(),O("tr",{key:k},[r("td",null,I(S.contract_code),1),r("td",null,I(h(S.gmt_create)),1),r("td",null,[r("span",{class:H(["trade-type",S.business===0?"buy":"sell"])},I(S.business===0?"买入":"卖出"),3)]),r("td",null,[r("span",{class:H(["product-type",p(S.type)])},I(d(S.type)),3)]),r("td",null,[r("span",{class:H(["direction",S.direction===0?"long":"short"])},I(S.direction===0?"开":"平"),3)]),r("td",null,I(Math.abs(S.volume)),1),r("td",null,I(u(S.price)),1),r("td",null,I(u(S.cost)),1)]))),128))])])])])):(L(),O("div",Go,[at(ee,{visible:z(n).loading.backtestTrade},null,8,["visible"])]))}},Wo=ft(Jo,[["__scopeId","data-v-77917df8"]]),Yo={key:0,class:"table-container"},Ko={class:"table-container-inner"},Xo={class:"data-table"},Zo={class:"sub-row"},Qo={class:"sub-row"},tr={class:"sub-row"},er={class:"sub-row"},nr={key:1,class:"table-container"},sr={__name:"cc",props:{back_id:{type:String,required:!0},currentPage:{type:Number,default:1},pageSize:{type:Number,default:10}},emits:["update:pagination"],setup(e,{emit:t}){const n=kt(),s=e,a=t,o=$([]),i=$(1),l=$(0),h=p=>{if(p==null)return"¥0.00";const _=p<0,g=Math.abs(p);return g>=1e4?`${_?"-":""}¥${(g/1e4).toFixed(2)}万`:`${_?"-":""}¥${g.toFixed(2)}`},u=p=>{if(!p)return"";const _=p.substring(0,4),g=p.substring(4,6),b=p.substring(6,8);return`${_}/${g}/${b}`},d=async()=>{try{await n.fetchBacktestAccount(s.back_id,s.currentPage,s.pageSize),n.backtestAccount&&n.backtestAccount.data&&(o.value=n.backtestAccount.data.items||[],n.backtestAccount.data.pagination&&(l.value=n.backtestAccount.data.pagination.total,i.value=n.backtestAccount.data.pagination.total_pages,a("update:pagination",{currentPage:n.backtestAccount.data.pagination.page,pageSize:n.backtestAccount.data.pagination.page_size,totalPages:i.value,totalItems:l.value})))}catch(p){console.error("获取回测账户数据失败",p)}};return it(()=>s.back_id,()=>{d()}),it(()=>s.currentPage,()=>{d()}),it(()=>s.pageSize,()=>{d()}),Tt(async()=>{await d()}),(p,_)=>o.value.length>0?(L(),O("div",Yo,[r("div",Ko,[r("table",Xo,[_[0]||(_[0]=r("thead",null,[r("tr",null,[r("th",null,"日期"),r("th",null,"账户类别"),r("th",null,"可用资金"),r("th",null,"总权益"),r("th",null,"累计盈亏"),r("th",null,"市值"),r("th",null,"累计费用")])],-1)),r("tbody",null,[(L(!0),O(ot,null,bt(o.value,(g,b)=>(L(),O("tr",{key:b},[r("td",null,I(u(g.gmt_create)),1),r("td",null,[r("div",null,I(g.type===1?"股票":"期货"),1)]),r("td",null,[r("div",null,I(h(g.available_funds)),1),r("div",Zo,I(h(g.available_funds)),1)]),r("td",null,[r("div",null,I(h(g.start_capital)),1),r("div",Qo,I(h(g.yes_total_capital)),1)]),r("td",null,[r("div",{class:H(["profit",g.total_profit-g.start_capital<0?"negative":"positive"])},I(h(g.total_profit-g.start_capital)),3),r("div",{class:H(["sub-row profit",g.add_profit<0?"negative":"positive"])},I(h(g.add_profit)),3)]),r("td",null,[r("div",null,I(h(g.market_value)),1),r("div",tr,I(h(g.market_value)),1)]),r("td",null,[r("div",null,I(h(g.cost)),1),r("div",er,I(h(g.cost)),1)])]))),128))])])])])):(L(),O("div",nr,[at(ee,{visible:z(n).loading.backtestAccount},null,8,["visible"])]))}},ar=ft(sr,[["__scopeId","data-v-02ea9a5e"]]),or={class:"strategy-container"},rr={key:1,class:"strategy-container-content"},ir={class:"strategy-header"},lr={class:"strategy-header-right"},cr={key:0,class:"pagination"},ur=["disabled"],dr={class:"page-numbers"},fr=["onClick","disabled"],pr={key:1,class:"ellipsis"},hr=["disabled"],br={key:1,class:"pagination"},gr=["disabled"],yr={class:"page-numbers"},mr=["onClick","disabled"],vr={key:1,class:"ellipsis"},wr=["disabled"],_r={class:"strategy-content"},kr={key:0,class:"tab-content"},Er={key:1,class:"tab-content"},Sr={key:2,class:"tab-content"},Cr=Ft({__name:"index",emits:["apply"],setup(e,{expose:t,emit:n}){const s=We(),a=kt(),o=$("我的工作流"),i=$(!0),l=$(null),h=()=>{var P;(P=l.value)==null||P.openDialog()},u=n,d=$(!0),p=[{label:"收益概览",value:"strategy_overview"},{label:"交易详情",value:"strategy_details"},{label:"账户信息",value:"strategy_account"}];a.child_currentFootTab="strategy_overview";const _=$(1),g=$(40),b=$(1),S=$(0),k=$(!1),R=$(1),y=$(40),w=$(1),M=$(0),U=$(!1),G=P=>{_.value=P.currentPage,g.value=P.pageSize,b.value=P.totalPages,S.value=P.totalItems,k.value=!1},Q=P=>{R.value=P.currentPage,y.value=P.pageSize,w.value=P.totalPages,M.value=P.totalItems,U.value=!1},C=P=>{k.value||(k.value=!0,_.value=P)},f=P=>{U.value||(U.value=!0,R.value=P)},j=pt(()=>{const P=[];if(b.value<=5)for(let m=1;m<=b.value;m++)P.push(m);else{P.push(1);let m=Math.max(2,_.value-1),A=Math.min(b.value-1,_.value+1);m===2&&(A=Math.min(b.value-1,4)),A===b.value-1&&(m=Math.max(2,b.value-3)),m>2&&P.push("left-ellipsis");for(let v=m;v<=A;v++)P.push(v);A<b.value-1&&P.push("right-ellipsis"),P.push(b.value)}return P}),N=pt(()=>{const P=[];if(w.value<=5)for(let m=1;m<=w.value;m++)P.push(m);else{P.push(1);let m=Math.max(2,R.value-1),A=Math.min(w.value-1,R.value+1);m===2&&(A=Math.min(w.value-1,4)),A===w.value-1&&(m=Math.max(2,w.value-3)),m>2&&P.push("left-ellipsis");for(let v=m;v<=A;v++)P.push(v);A<w.value-1&&P.push("right-ellipsis"),P.push(w.value)}return P}),W=P=>{console.log("当前选中的tab:",P),P==="strategy_details"&&(_.value=1),P==="strategy_account"&&(R.value=1)},T=$(null),D=$({node_id:"",node_output:"",node_title:""}),x=$(null),V=async(P,E)=>{var F,B,K,ct,Et;if(E!==!1)try{const nt=await a.fetchBacktestLastRunId(P.workflow_id,P.feature_tag,P.locator);if(nt.code===0)T.value=nt.data;else if(nt.code===-1001){s.warning("工作流正在运行，请等待完成后再点击应用！"),(F=x.value)==null||F.resetLoadingState();return}else if(nt.code===-1002){s.error("工作流运行错误，请重新去工作流重新运行！"),(B=x.value)==null||B.resetLoadingState();return}else if(nt.code===-1003){s.warning("工作流没有运行过，请去工作流运行！"),(K=x.value)==null||K.resetLoadingState();return}console.log("applyData.value",T.value),nt.data&&nt.data.length>0&&(D.value=nt.data[0])}catch(nt){console.log("请求接口出错:",nt),s.error("请求接口出错，请检查网络！"),(ct=x.value)==null||ct.resetLoadingState();return}else D.value.node_output=P.workflow_id;(Et=x.value)==null||Et.resetLoadingState(),E===!1&&(i.value=!1),console.log("应用项目：",P),d.value=!1,o.value=P.title;const m=P.timeRange||a.timeRange,A=P.startDate||a.startDate,v=P.endDate||a.endDate;u("apply",{type:"strategy",positionHeight:40,selectedApplyData:D.value,timeRange:m,startDate:A,endDate:v})},Y=()=>{d.value=!0,a.child_currentFootTab="strategy_overview",u("apply",{type:"strategy",positionHeight:0})};return Tt(async()=>{await a.fetchBacktestList(),console.log("策略列表返回的数据:",a.backtestList)}),t({handleApply:V}),(P,E)=>{var m,A,v;return L(),O(ot,null,[r("div",or,[d.value?(L(),Pn(eo,{key:0,ref_key:"tableaRef",ref:x,onApply:V,tableData:z(a).backtestList||[]},null,8,["tableData"])):(L(),O("div",rr,[r("div",ir,[at(Sa,{onBack:Y,backs:i.value,title:o.value},null,8,["backs","title"]),at(kn,{"tab-list":p,tab:z(a).child_currentFootTab,"onUpdate:tab":[E[0]||(E[0]=F=>z(a).child_currentFootTab=F),W]},null,8,["tab"]),r("div",lr,[r("div",{class:"showlog-btn",onClick:h}," 查看日志 "),z(a).child_currentFootTab==="strategy_details"?(L(),O("div",cr,[r("button",{disabled:_.value===1||k.value,onClick:E[1]||(E[1]=F=>C(_.value-1)),class:"page-btn"},E[5]||(E[5]=[r("svg",{class:"arrow-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})],-1)]),8,ur),r("div",dr,[(L(!0),O(ot,null,bt(j.value,(F,B)=>(L(),O(ot,{key:B},[typeof F=="number"?(L(),O("button",{key:0,class:H(["page-number",_.value===F?"active":""]),onClick:K=>C(F),disabled:k.value},I(F),11,fr)):(L(),O("span",pr,"..."))],64))),128))]),r("button",{disabled:_.value===b.value||k.value,onClick:E[2]||(E[2]=F=>C(_.value+1)),class:"page-btn"},E[6]||(E[6]=[r("svg",{class:"arrow-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})],-1)]),8,hr)])):rt("",!0),z(a).child_currentFootTab==="strategy_account"?(L(),O("div",br,[r("button",{disabled:R.value===1||U.value,onClick:E[3]||(E[3]=F=>f(R.value-1)),class:"page-btn"},E[7]||(E[7]=[r("svg",{class:"arrow-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})],-1)]),8,gr),r("div",yr,[(L(!0),O(ot,null,bt(N.value,(F,B)=>(L(),O(ot,{key:B},[typeof F=="number"?(L(),O("button",{key:0,class:H(["page-number",R.value===F?"active":""]),onClick:K=>f(F),disabled:U.value},I(F),11,mr)):(L(),O("span",vr,"..."))],64))),128))]),r("button",{disabled:R.value===w.value||U.value,onClick:E[4]||(E[4]=F=>f(R.value+1)),class:"page-btn"},E[8]||(E[8]=[r("svg",{class:"arrow-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})],-1)]),8,wr)])):rt("",!0)])]),r("div",_r,[z(a).child_currentFootTab==="strategy_overview"?(L(),O("div",kr,[at(Mo,{back_id:(m=D.value)==null?void 0:m.node_output},null,8,["back_id"])])):rt("",!0),z(a).child_currentFootTab==="strategy_details"?(L(),O("div",Er,[at(Wo,{back_id:(A=D.value)==null?void 0:A.node_output,"current-page":_.value,"page-size":g.value,"onUpdate:pagination":G},null,8,["back_id","current-page","page-size"])])):rt("",!0),z(a).child_currentFootTab==="strategy_account"?(L(),O("div",Sr,[at(ar,{back_id:(v=D.value)==null?void 0:v.node_output,"current-page":R.value,"page-size":y.value,"onUpdate:pagination":Q},null,8,["back_id","current-page","page-size"])])):rt("",!0)])]))]),at(wo,{ref_key:"logsDialog",ref:l},null,512)],64)}}}),ci=ft(Cr,[["__scopeId","data-v-1dd622a3"]]);export{$r as G,wo as L,xa as N,Sa as T,Mr as a,qr as b,Ur as c,Ar as d,Dr as e,Pr as f,Lr as g,Or as h,Fr as i,jr as j,Nr as k,ee as l,Br as m,Ir as n,xr as o,J as p,Je as q,ii as r,ci as s,li as t,kt as u,kn as v};
